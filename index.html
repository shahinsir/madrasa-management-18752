<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>মাদ্রাসা ম্যানেজমেন্ট সিস্টেম</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- PWA Configurations -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="https://i.ibb.co.com/hhVX9hp/android-chrome-192x192.png">
    <link rel="apple-touch-icon" href="https://i.ibb.co.com/hhVX9hp/android-chrome-192x192.png">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="মাদ্রাসা ম্যানেজমেন্ট">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap');
        
        body { 
            font-family: 'Hind Siliguri', sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .nav-tab {
            transition: all 0.3s ease;
        }
        
        .nav-tab.active {
            background: #4f46e5;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 70, 229, 0.3);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .index-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }
        
        .madrasa-info {
            background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%);
            border-radius: 10px;
            padding: 10px 15px;
            margin-top: 10px;
        }
        
        .info-item {
            display: inline-block;
            margin-right: 20px;
            font-size: 14px;
            color: #4a5568;
        }
        
        .info-item i {
            margin-right: 5px;
            color: #4f46e5;
        }
        
        .user-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .admin-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .user-badge-normal {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        /* লগইন স্ক্রিন ইম্প্রুভমেন্ট */
        .login-container {
            animation: fadeIn 0.6s ease-out;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .login-logo {
            width: 90px;
            height: 90px;
            margin: 0 auto 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: white;
            font-weight: bold;
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
            transform: rotate(-5deg);
        }
        
        .login-logo i {
            transform: rotate(5deg);
        }
        
        .login-title {
            font-size: 28px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }
        
        .login-subtitle {
            font-size: 15px;
            color: #718096;
            line-height: 1.5;
        }
        
        .form-group {
            margin-bottom: 24px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #4a5568;
            font-size: 15px;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
            background-color: white;
            font-family: 'Hind Siliguri', sans-serif;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15);
            transform: translateY(-1px);
        }
        
        .password-container {
            position: relative;
        }
        
        .toggle-password {
            position: absolute;
            right: 18px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #718096;
            cursor: pointer;
            padding: 5px;
            font-size: 18px;
        }
        
        .login-button {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Hind Siliguri', sans-serif;
            letter-spacing: 0.5px;
            margin-top: 10px;
        }
        
        .login-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }
        
        .login-button:active {
            transform: translateY(-1px);
        }
        
        .login-footer {
            text-align: center;
            margin-top: 30px;
            font-size: 14px;
            color: #a0aec0;
            padding-top: 25px;
            border-top: 1px solid #e2e8f0;
        }
        
        .role-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
        }
        
        .role-option {
            padding: 14px 28px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            flex: 1;
            text-align: center;
            max-width: 200px;
        }
        
        .role-admin {
            background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%);
            color: #4f46e5;
            border-color: #4f46e5;
        }
        
        .role-user {
            background: linear-gradient(135deg, #10b98120 0%, #05966920 100%);
            color: #059669;
            border-color: #059669;
        }
        
        .role-option.active {
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .role-admin.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .role-user.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .role-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        .credential-hint {
            background: linear-gradient(135deg, #f6f8ff 0%, #f0f4ff 100%);
            border-radius: 12px;
            padding: 20px;
            margin-top: 30px;
            border-left: 5px solid #667eea;
        }
        
        .credential-title {
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 12px;
            font-size: 16px;
            display: flex;
            align-items: center;
        }
        
        .credential-title i {
            margin-right: 10px;
            color: #667eea;
        }
        
        .credential-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .credential-item:last-child {
            border-bottom: none;
        }
        
        .credential-role {
            font-weight: 600;
            color: #4a5568;
        }
        
        .credential-details {
            color: #718096;
            font-size: 14px;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
            animation: fadeIn 0.3s ease-out;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.4s ease-out;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f1f5f9;
        }
        
        .modal-title {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
            display: flex;
            align-items: center;
        }
        
        .modal-title i {
            margin-right: 12px;
            color: #667eea;
        }
        
        .close-button {
            background: none;
            border: none;
            font-size: 24px;
            color: #94a3b8;
            cursor: pointer;
            padding: 5px;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .close-button:hover {
            background-color: #f1f5f9;
            color: #64748b;
        }
        
        /* স্পেশাল নোটিফিকেশন স্টাইল */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 18px 24px;
            border-radius: 12px;
            color: white;
            font-weight: 500;
            z-index: 1001;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            animation: slideInRight 0.4s ease-out;
            max-width: 400px;
        }
        
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(100px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .notification-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .notification-error {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        
        .notification-info {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
        }
        
        .notification i {
            margin-right: 12px;
            font-size: 20px;
        }
        
        /* লোডিং স্টাইল */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* iOS সেফ এরিয়া সাপোর্ট */
        @supports (-webkit-touch-callout: none) {
            body {
                padding-top: env(safe-area-inset-top);
                padding-bottom: env(safe-area-inset-bottom);
                min-height: -webkit-fill-available;
            }
        }
        
        /* PWA ফিক্স স্টাইলস */
        @media (display-mode: standalone) {
            body {
                padding: 0 !important;
            }
            
            .login-container {
                min-height: 100vh;
                min-height: -webkit-fill-available;
            }
        }
        
        /* উন্নত স্টুডেন্ট/টিচার ফর্ম */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .form-section {
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
            display: flex;
            align-items: center;
        }
        
        .section-title i {
            margin-right: 10px;
            color: #667eea;
        }
        
        /* এনিমেশন ক্লাসেস */
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .float {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        /* উন্নত লগআউট কনফার্মেশন */
        .logout-modal {
            max-width: 500px;
        }
        
        .logout-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 25px;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: white;
            box-shadow: 0 15px 30px rgba(239, 68, 68, 0.3);
        }
        
        .logout-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: center;
        }
        
        .logout-btn {
            padding: 14px 32px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            min-width: 140px;
        }
        
        .logout-confirm {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }
        
        .logout-confirm:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(239, 68, 68, 0.3);
        }
        
        .logout-cancel {
            background: #f1f5f9;
            color: #64748b;
            border-color: #e2e8f0;
        }
        
        .logout-cancel:hover {
            background: #e2e8f0;
        }
        
        /* পাসওয়ার্ড হাইড স্টাইল */
        .password-hint {
            position: absolute;
            right: 50px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #718096;
            cursor: pointer;
            padding: 5px;
            font-size: 16px;
        }
        
        .show-password {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            z-index: 1002;
            cursor: pointer;
            display: none;
        }
        
        .show-password:hover {
            background: rgba(0,0,0,0.9);
        }
    </style>
</head>
<body class="min-h-screen">

    <!-- লগইন স্ক্রিন (ইম্প্রুভড) -->
    <div id="loginModal" class="login-container">
        <div class="glass-card p-8 w-full max-w-md mx-4">
            <div class="login-header">
                <div class="login-logo float">
                    <i class="fas fa-mosque"></i>
                </div>
                <h1 class="login-title">মাদ্রাসা ম্যানেজমেন্ট</h1>
                <p class="login-subtitle">মেহেরপুর আনছারুল উলূম আলিম মাদ্রাসা</p>
                
                <!-- রোল সিলেক্টর -->
                <div class="role-selector">
                    <div id="adminRole" class="role-option role-admin active" onclick="selectRole('admin')">
                        <div class="role-icon">
                            <i class="fas fa-user-shield"></i>
                        </div>
                        <div>এডমিন</div>
                    </div>
                    <div id="userRole" class="role-option role-user" onclick="selectRole('user')">
                        <div class="role-icon">
                            <i class="fas fa-user"></i>
                        </div>
                        <div>ইউজার</div>
                    </div>
                </div>
            </div>
            
            <form id="loginForm" onsubmit="event.preventDefault(); login();">
                <div class="form-group">
                    <label class="form-label" for="loginEmail">
                        <i class="fas fa-envelope mr-1"></i>ইমেইল এড্রেস
                    </label>
                    <input type="email" id="loginEmail" class="form-input" placeholder="আপনার ইমেইল লিখুন" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="loginPassword">
                        <i class="fas fa-lock mr-1"></i>পাসওয়ার্ড
                    </label>
                    <div class="password-container">
                        <input type="password" id="loginPassword" class="form-input pr-12" placeholder="আপনার পাসওয়ার্ড লিখুন" required>
                        <button type="button" class="toggle-password" onclick="togglePassword()">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div class="login-options">
                    <label class="flex items-center cursor-pointer">
                        <input type="checkbox" id="rememberMe" class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                        <span class="ml-2 text-gray-700 text-sm">লগইন তথ্য মনে রাখুন</span>
                    </label>
                    <button type="button" class="text-blue-600 hover:text-blue-800 text-sm font-medium" onclick="showForgotPassword()">
                        পাসওয়ার্ড ভুলে গেছেন?
                    </button>
                </div>
                
                <button type="submit" id="loginBtn" class="login-button pulse">
                    <i class="fas fa-sign-in-alt mr-2"></i>লগইন করুন
                </button>
            </form>
            
            <!-- লগইন গোপন তথ্য -->
            <div class="credential-hint mt-8">
                <div class="credential-title">
                    <i class="fas fa-shield-alt"></i>
                    নিরাপদ লগইন সিস্টেম
                </div>
                <div class="mt-3">
                    <div class="credential-item">
                        <span class="credential-role" id="currentRoleTitle">এডমিন লগইন:</span>
                        <span class="credential-details" id="currentRoleCreds">
                            ইমেইল: admin@madrasa.com
                        </span>
                    </div>
                    <div class="credential-item">
                        <span class="credential-role" id="currentRoleTitle2">ইউজার লগইন:</span>
                        <span class="credential-details" id="currentRoleCreds2">
                            ইমেইল: user@madrasa.com
                        </span>
                    </div>
                    <div class="credential-item">
                        <span class="credential-role">সাহায্যের জন্য:</span>
                        <span class="credential-details">মোবাইল: ০১৭১১-১৮৬০৮১</span>
                    </div>
                </div>
            </div>
            
            <div class="login-footer">
                <p class="text-sm text-gray-600">
                    <strong>EIIN:</strong> ১৩০২৯০ | <strong>মাদ্রাসা কোড:</strong> ১৮৭৫২
                </p>
                <p class="text-xs mt-3 text-gray-500">
                    সম্পূর্ণ ডিজিটাল ম্যানেজমেন্ট সিস্টেম
                </p>
            </div>
        </div>
    </div>

    <!-- পাসওয়ার্ড দেখার বাটন (শুধু ডেভেলপারদের জন্য) -->
    <button id="showPasswordBtn" class="show-password" onclick="togglePasswordHint()">
        <i class="fas fa-key mr-1"></i>পাসওয়ার্ড দেখুন
    </button>

    <!-- মূল অ্যাপ কন্টেন্ট (লগইনের পর শো হবে) -->
    <div id="appContent" class="hidden min-h-screen p-4 md:p-8">
        <div class="max-w-7xl mx-auto">
            <!-- হেডার -->
            <div class="glass-card p-6 mb-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="text-center md:text-left mb-6 md:mb-0">
                        <div class="flex flex-col md:flex-row items-center justify-center md:justify-start">
                            <h1 class="text-3xl md:text-4xl font-bold gradient-text mb-4 md:mb-0 md:mr-6">
                                মেহেরপুর আনছারুল উলূম আলিম মাদ্রাসা
                            </h1>
                            <span id="userRoleBadge" class="user-badge"></span>
                        </div>
                        
                        <!-- মাদ্রাসা তথ্য -->
                        <div class="madrasa-info mt-4">
                            <span class="info-item">
                                <i class="fas fa-hashtag"></i>মাদ্রাসা কোড: <strong>১৮৭৫২</strong>
                            </span>
                            <span class="info-item">
                                <i class="fas fa-id-card"></i>EIIN No: <strong>১৩০২৯০</strong>
                            </span>
                            <span class="info-item">
                                <i class="fas fa-phone"></i>মোবাইল: <strong>০১৩০৯-১৩০২৯০</strong>
                            </span>
                            <span class="info-item">
                                <i class="fas fa-map-marker-alt"></i>মেহেরপুর, গোলাপগঞ্জ, সিলেট
                            </span>
                        </div>
                        
                        <p class="text-gray-600 mt-4 text-sm md:text-base">সম্পূর্ণ ডিজিটাল ম্যানেজমেন্ট সিস্টেম</p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="text-right">
                            <p class="text-gray-600" id="currentDateBangla"></p>
                            <p class="text-sm text-gray-500" id="currentTime"></p>
                            <button onclick="showLogoutConfirm()" class="text-sm text-red-600 hover:text-red-800 mt-1 font-medium flex items-center">
                                <i class="fas fa-sign-out-alt mr-1"></i>লগআউট
                            </button>
                        </div>
                        <div class="w-14 h-14 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center text-white font-bold shadow-lg">
                            <i class="fas fa-mosque text-xl"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- নেভিগেশন ট্যাব -->
            <div class="glass-card p-4 mb-8">
                <div class="flex flex-wrap gap-3 justify-center">
                    <button onclick="showSection('dashboard')" id="tab-dashboard" class="nav-tab px-6 py-3 rounded-xl bg-blue-50 text-blue-700 font-semibold active">
                        <i class="fas fa-tachometer-alt mr-2"></i>ড্যাশবোর্ড
                    </button>
                    <button onclick="showSection('students')" id="tab-students" class="nav-tab px-6 py-3 rounded-xl bg-green-50 text-green-700 font-semibold">
                        <i class="fas fa-user-graduate mr-2"></i>ছাত্র-ছাত্রী
                    </button>
                    <button onclick="showSection('teachers')" id="tab-teachers" class="nav-tab px-6 py-3 rounded-xl bg-purple-50 text-purple-700 font-semibold">
                        <i class="fas fa-chalkboard-teacher mr-2"></i>শিক্ষক-কর্মচারী
                    </button>
                    <button onclick="showSection('attendance')" id="tab-attendance" class="nav-tab px-6 py-3 rounded-xl bg-orange-50 text-orange-700 font-semibold">
                        <i class="fas fa-calendar-check mr-2"></i>হাজিরা ব্যবস্থাপনা
                    </button>
                    <button onclick="showSection('finance')" id="tab-finance" class="nav-tab px-6 py-3 rounded-xl bg-red-50 text-red-700 font-semibold">
                        <i class="fas fa-money-bill-wave mr-2"></i>আর্থিক ব্যবস্থাপনা
                    </button>
                </div>
            </div>

            <!-- ড্যাশবোর্ড সেকশন -->
            <div id="section-dashboard" class="section-content">
                <!-- সারাংশ কার্ড -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-10">
                    <div class="bg-gradient-to-r from-green-500 to-green-600 p-6 rounded-2xl text-white shadow-lg transform hover:scale-105 transition duration-300 cursor-pointer" onclick="showSection('students')">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg">মোট ছাত্র-ছাত্রী</h3>
                            <i class="fas fa-user-graduate text-2xl opacity-80"></i>
                        </div>
                        <p class="text-3xl font-bold mt-2"><span id="totalStudents">০</span></p>
                        <p class="text-sm opacity-90 mt-1">সকল শ্রেণির</p>
                    </div>

                    <div class="bg-gradient-to-r from-purple-500 to-purple-600 p-6 rounded-2xl text-white shadow-lg transform hover:scale-105 transition duration-300 cursor-pointer" onclick="showSection('teachers')">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg">মোট শিক্ষক-কর্মচারী</h3>
                            <i class="fas fa-chalkboard-teacher text-2xl opacity-80"></i>
                        </div>
                        <p class="text-3xl font-bold mt-2"><span id="totalTeachers">০</span></p>
                        <p class="text-sm opacity-90 mt-1">সকল বিভাগ</p>
                    </div>

                    <div class="bg-gradient-to-r from-blue-500 to-blue-600 p-6 rounded-2xl text-white shadow-lg transform hover:scale-105 transition duration-300 cursor-pointer" onclick="showSection('finance')">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg">মাসিক আয়</h3>
                            <i class="fas fa-arrow-up text-2xl opacity-80"></i>
                        </div>
                        <p class="text-3xl font-bold mt-2">৳ <span id="monthlyIncome">০</span></p>
                        <p class="text-sm opacity-90 mt-1">এই মাসের</p>
                    </div>

                    <div class="bg-gradient-to-r from-red-500 to-red-600 p-6 rounded-2xl text-white shadow-lg transform hover:scale-105 transition duration-300 cursor-pointer" onclick="showSection('finance')">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg">মাসিক ব্যয়</h3>
                            <i class="fas fa-arrow-down text-2xl opacity-80"></i>
                        </div>
                        <p class="text-3xl font-bold mt-2">৳ <span id="monthlyExpense">০</span></p>
                        <p class="text-sm opacity-90 mt-1">এই মাসের</p>
                    </div>
                </div>

                <!-- রিসেন্ট অ্যাক্টিভিটি -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="glass-card p-6">
                        <h3 class="text-xl font-bold mb-4 text-gray-700 flex items-center">
                            <i class="fas fa-history mr-2 text-blue-500"></i>
                            সাম্প্রতিক লেনদেন
                        </h3>
                        <div class="space-y-4 max-h-80 overflow-y-auto pr-2">
                            <div id="recentTransactions" class="space-y-3">
                                <!-- রিসেন্ট লেনদেন -->
                            </div>
                        </div>
                    </div>

                    <div class="glass-card p-6">
                        <h3 class="text-xl font-bold mb-4 text-gray-700 flex items-center">
                            <i class="fas fa-chart-pie mr-2 text-green-500"></i>
                            শ্রেণি ভিত্তিক ছাত্র সংখ্যা
                        </h3>
                        <div class="space-y-3">
                            <div id="classDistribution">
                                <!-- শ্রেণি ভিত্তিক ডিস্ট্রিবিউশন -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ছাত্র-ছাত্রী সেকশন -->
            <div id="section-students" class="section-content hidden">
                <div class="glass-card p-6 mb-6">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                        <h3 class="text-2xl font-bold text-gray-700 mb-4 md:mb-0">
                            <i class="fas fa-user-graduate mr-2 text-green-500"></i>
                            ছাত্র-ছাত্রী তথ্য ব্যবস্থাপনা
                        </h3>
                        <div class="flex space-x-2">
                            <button onclick="exportStudentData()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition duration-300 shadow-md">
                                <i class="fas fa-file-export mr-2"></i>এক্সপোর্ট
                            </button>
                            <button id="addStudentBtn" onclick="showAddStudentModal()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-300 shadow-md">
                                <i class="fas fa-user-plus mr-2"></i>নতুন ছাত্র যোগ করুন
                            </button>
                        </div>
                    </div>

                    <!-- ফিল্টার অপশন -->
                    <div class="mb-6">
                        <div class="flex flex-wrap gap-4 items-center">
                            <select id="filterClass" onchange="filterStudents()" class="p-3 border rounded-lg bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="">সকল শ্রেণি</option>
                                <option value="1">১ম শ্রেণি</option>
                                <option value="2">২য় শ্রেণি</option>
                                <option value="3">৩য় শ্রেণি</option>
                                <option value="4">৪র্থ শ্রেণি</option>
                                <option value="5">৫ম শ্রেণি</option>
                                <option value="6">৬ষ্ঠ শ্রেণি</option>
                                <option value="7">৭ম শ্রেণি</option>
                                <option value="8">৮ম শ্রেণি</option>
                                <option value="9">৯ম শ্রেণি</option>
                                <option value="10">১০ম শ্রেণি</option>
                                <option value="11">১১তম শ্রেণি</option>
                                <option value="12">১২তম শ্রেণি</option>
                            </select>
                            
                            <div class="relative flex-1 min-w-[250px]">
                                <input type="text" id="searchStudent" placeholder="ছাত্র/ছাত্রী নাম অনুসন্ধান..." 
                                       class="p-3 pl-12 border rounded-lg w-full bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                                       onkeyup="filterStudents()">
                                <i class="fas fa-search text-gray-400 absolute left-4 top-3.5"></i>
                            </div>
                        </div>
                    </div>

                    <!-- ছাত্র টেবিল -->
                    <div class="overflow-x-auto rounded-xl border shadow-sm">
                        <table class="w-full">
                            <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
                                <tr>
                                    <th class="p-4 text-left font-semibold text-gray-700">ক্রমিক নং</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">আইডি নং</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">রোল নং</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">নাম</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">শ্রেণি</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">পিতার নাম</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">মাতার নাম</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">মোবাইল</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">গ্রাম</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">কার্যক্রম</th>
                                </tr>
                            </thead>
                            <tbody id="studentTableBody">
                                <!-- ছাত্র তথ্য -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- খালি অবস্থা -->
                    <div id="emptyStudents" class="text-center py-12 hidden">
                        <i class="fas fa-user-graduate text-5xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl text-gray-500 mb-2">কোন ছাত্র-ছাত্রী নেই</h3>
                        <p class="text-gray-400">ছাত্র-ছাত্রী তথ্য লোড হচ্ছে...</p>
                    </div>
                </div>
            </div>

            <!-- শিক্ষক-কর্মচারী সেকশন -->
            <div id="section-teachers" class="section-content hidden">
                <div class="glass-card p-6">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                        <h3 class="text-2xl font-bold text-gray-700 mb-4 md:mb-0">
                            <i class="fas fa-chalkboard-teacher mr-2 text-purple-500"></i>
                            শিক্ষক-কর্মচারী তথ্য ব্যবস্থাপনা
                        </h3>
                        <div class="flex space-x-2">
                            <button onclick="exportTeacherData()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition duration-300 shadow-md">
                                <i class="fas fa-file-export mr-2"></i>এক্সপোর্ট
                            </button>
                            <button id="addTeacherBtn" onclick="showAddTeacherModal()" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition duration-300 shadow-md">
                                <i class="fas fa-user-tie mr-2"></i>নতুন শিক্ষক যোগ করুন
                            </button>
                        </div>
                    </div>

                    <!-- শিক্ষক টেবিল -->
                    <div class="overflow-x-auto rounded-xl border shadow-sm">
                        <table class="w-full">
                            <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
                                <tr>
                                    <th class="p-4 text-left font-semibold text-gray-700">ক্রমিক নং</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">আইডি নং</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">নাম</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">পদবী</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">বিষয়</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">মোবাইল</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">এনআইডি</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">বেতন</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">যোগদান তারিখ</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">কার্যক্রম</th>
                                </tr>
                            </thead>
                            <tbody id="teacherTableBody">
                                <!-- শিক্ষক তথ্য -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- খালি অবস্থা -->
                    <div id="emptyTeachers" class="text-center py-12 hidden">
                        <i class="fas fa-chalkboard-teacher text-5xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl text-gray-500 mb-2">কোন শিক্ষক-কর্মচারী নেই</h3>
                        <p class="text-gray-400">শিক্ষক-কর্মচারী তথ্য লোড হচ্ছে...</p>
                    </div>
                </div>
            </div>

            <!-- হাজিরা ব্যবস্থাপনা সেকশন -->
            <div id="section-attendance" class="section-content hidden">
                <div class="glass-card p-6">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                        <h3 class="text-2xl font-bold text-gray-700 mb-4 md:mb-0">
                            <i class="fas fa-calendar-check mr-2 text-orange-500"></i>
                            শিক্ষক ও কর্মচারী হাজিরা ব্যবস্থাপনা
                        </h3>
                        <div class="flex space-x-2">
                            <button onclick="exportAttendanceData()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition duration-300 shadow-md">
                                <i class="fas fa-file-export mr-2"></i>এক্সপোর্ট
                            </button>
                            <button id="addAttendanceBtn" onclick="showAttendanceModal()" class="px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition duration-300 shadow-md">
                                <i class="fas fa-plus-circle mr-2"></i>নতুন হাজিরা যোগ করুন
                            </button>
                        </div>
                    </div>

                    <!-- তারিখ নির্বাচন -->
                    <div class="mb-6">
                        <div class="flex flex-wrap gap-4 items-center">
                            <input type="date" id="attendanceFilterDate" class="p-3 border rounded-lg bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500" onchange="filterAttendance()">
                            
                            <select id="attendanceFilterMonth" class="p-3 border rounded-lg bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500" onchange="filterAttendance()">
                                <option value="">সকল মাস</option>
                                <option value="0">জানুয়ারী</option>
                                <option value="1">ফেব্রুয়ারী</option>
                                <option value="2">মার্চ</option>
                                <option value="3">এপ্রিল</option>
                                <option value="4">মে</option>
                                <option value="5">জুন</option>
                                <option value="6">জুলাই</option>
                                <option value="7">আগস্ট</option>
                                <option value="8">সেপ্টেম্বর</option>
                                <option value="9">অক্টোবর</option>
                                <option value="10">নভেম্বর</option>
                                <option value="11">ডিসেম্বর</option>
                            </select>
                            
                            <select id="attendanceFilterStatus" class="p-3 border rounded-lg bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500" onchange="filterAttendance()">
                                <option value="">সকল অবস্থা</option>
                                <option value="present">উপস্থিত</option>
                                <option value="absent">অনুপস্থিত</option>
                                <option value="late">বিলম্বিত</option>
                                <option value="leave">ছুটি</option>
                            </select>
                            
                            <div class="relative flex-1 min-w-[250px]">
                                <input type="text" id="attendanceSearch" placeholder="শিক্ষক/কর্মচারীর নাম অনুসন্ধান..." 
                                       class="p-3 pl-12 border rounded-lg w-full bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500"
                                       onkeyup="filterAttendance()">
                                <i class="fas fa-search text-gray-400 absolute left-4 top-3.5"></i>
                            </div>
                        </div>
                    </div>

                    <!-- হাজিরা টেবিল -->
                    <div class="overflow-x-auto rounded-xl border shadow-sm">
                        <table class="w-full">
                            <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
                                <tr>
                                    <th class="p-4 text-left font-semibold text-gray-700">তারিখ</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">শিক্ষক/কর্মচারী</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">পদবী</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">হাজিরার অবস্থা</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">প্রবেশের সময়</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">প্রস্থানের সময়</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">মন্তব্য</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">কার্যক্রম</th>
                                </tr>
                            </thead>
                            <tbody id="attendanceTableBody">
                                <!-- হাজিরা তথ্য লোড হবে -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- খালি অবস্থা -->
                    <div id="emptyAttendance" class="text-center py-12 hidden">
                        <i class="fas fa-calendar-times text-5xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl text-gray-500 mb-2">কোন হাজিরা রেকর্ড নেই</h3>
                        <p class="text-gray-400">নতুন হাজিরা যোগ করুন</p>
                    </div>
                    
                    <!-- হাজিরা সারাংশ -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-6">
                        <div class="bg-gradient-to-r from-green-500 to-green-600 p-4 rounded-xl text-white shadow-md">
                            <div class="flex justify-between items-center">
                                <h3 class="text-sm">উপস্থিত</h3>
                                <i class="fas fa-user-check text-xl opacity-80"></i>
                            </div>
                            <p class="text-2xl font-bold mt-1"><span id="attendancePresentCount">০</span></p>
                        </div>
                        
                        <div class="bg-gradient-to-r from-red-500 to-red-600 p-4 rounded-xl text-white shadow-md">
                            <div class="flex justify-between items-center">
                                <h3 class="text-sm">অনুপস্থিত</h3>
                                <i class="fas fa-user-times text-xl opacity-80"></i>
                            </div>
                            <p class="text-2xl font-bold mt-1"><span id="attendanceAbsentCount">০</span></p>
                        </div>
                        
                        <div class="bg-gradient-to-r from-yellow-500 to-yellow-600 p-4 rounded-xl text-white shadow-md">
                            <div class="flex justify-between items-center">
                                <h3 class="text-sm">বিলম্বিত</h3>
                                <i class="fas fa-clock text-xl opacity-80"></i>
                            </div>
                            <p class="text-2xl font-bold mt-1"><span id="attendanceLateCount">০</span></p>
                        </div>
                        
                        <div class="bg-gradient-to-r from-blue-500 to-blue-600 p-4 rounded-xl text-white shadow-md">
                            <div class="flex justify-between items-center">
                                <h3 class="text-sm">ছুটি</h3>
                                <i class="fas fa-umbrella-beach text-xl opacity-80"></i>
                            </div>
                            <p class="text-2xl font-bold mt-1"><span id="attendanceLeaveCount">০</span></p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- আর্থিক ব্যবস্থাপনা সেকশন -->
            <div id="section-finance" class="section-content hidden">
                <div class="glass-card p-6 mb-6">
                    <h3 class="text-2xl font-bold text-gray-700 mb-6">
                        <i class="fas fa-money-bill-wave mr-2 text-red-500"></i>
                        আর্থিক হিসাব ব্যবস্থাপনা
                    </h3>
                    
                    <!-- আর্থিক সারাংশ -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="bg-gradient-to-r from-green-500 to-green-600 p-6 rounded-2xl text-white shadow-lg">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg">মোট আয়</h3>
                                <i class="fas fa-arrow-up text-2xl opacity-80"></i>
                            </div>
                            <p class="text-3xl font-bold mt-2">৳ <span id="financeIncome">০</span></p>
                        </div>

                        <div class="bg-gradient-to-r from-red-500 to-red-600 p-6 rounded-2xl text-white shadow-lg">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg">মোট ব্যয়</h3>
                                <i class="fas fa-arrow-down text-2xl opacity-80"></i>
                            </div>
                            <p class="text-3xl font-bold mt-2">৳ <span id="financeExpense">০</span></p>
                        </div>

                        <div class="bg-gradient-to-r from-blue-500 to-blue-600 p-6 rounded-2xl text-white shadow-lg">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg">নেট ব্যালেন্স</h3>
                                <i class="fas fa-wallet text-2xl opacity-80"></i>
                            </div>
                            <p class="text-3xl font-bold mt-2">৳ <span id="financeBalance">০</span></p>
                        </div>
                    </div>

                    <!-- লেনদেন ফর্ম -->
                    <div id="financeForm" class="mb-8 hidden">
                        <h4 class="text-xl font-semibold mb-4 text-gray-700">
                            <i class="fas fa-plus-circle mr-2 text-blue-500"></i>নতুন লেনদেন যোগ করুন
                        </h4>
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                            <input id="financeDesc" type="text" placeholder="খাতের বিবরণ" class="p-3 border rounded-lg bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <input id="financeAmount" type="number" placeholder="পরিমাণ (৳)" class="p-3 border rounded-lg bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <input id="financeDate" type="date" class="p-3 border rounded-lg bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <select id="financeType" class="p-3 border rounded-lg bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="income">আয়</option>
                                <option value="expense">ব্যয়</option>
                            </select>
                            <button onclick="addFinancialTransaction()" class="bg-indigo-600 text-white p-3 rounded-lg hover:bg-indigo-700 transition duration-300 shadow-md">
                                <i class="fas fa-plus mr-2"></i>যোগ করুন
                            </button>
                        </div>
                    </div>

                    <!-- লেনদেন তালিকা -->
                    <div class="overflow-x-auto rounded-xl border shadow-sm">
                        <table class="w-full">
                            <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
                                <tr>
                                    <th class="p-4 text-left font-semibold text-gray-700">তারিখ</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">খাত</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">ধরণ</th>
                                    <th class="p-4 text-left font-semibold text-gray-700 text-right">পরিমাণ (৳)</th>
                                    <th class="p-4 text-left font-semibold text-gray-700">কার্যক্রম</th>
                                </tr>
                            </thead>
                            <tbody id="financeTableBody">
                                <!-- আর্থিক লেনদেন -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ফুটার -->
            <div class="glass-card p-6 mt-8 text-center text-gray-600" id="footer">
                <p class="font-medium">© ২০২৬ মেহেরপুর আনছারুল উলূম আলিম মাদ্রাসা। সকল অধিকার সংরক্ষিত।</p>
                <p class="text-sm mt-2">ডেভেলপড: মাদ্রাসা ম্যানেজমেন্ট সিস্টেম টিম | মাদ্রাসা কোড: ১৮৭৫২ | EIIN No: ১৩০২৯০</p>
                <p class="text-xs mt-1" id="syncStatus">ডেটা সিঙ্কিং...</p>
            </div>
        </div>
    </div>

    <!-- নোটিফিকেশন এলিমেন্ট -->
    <div id="notification" class="notification hidden">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText"></span>
    </div>

    <!-- লগআউট কনফার্মেশন মডেল -->
    <div id="logoutModal" class="modal-overlay hidden">
        <div class="modal-content logout-modal">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-sign-out-alt"></i>
                    লগআউট কনফার্মেশন
                </h3>
                <button onclick="hideModal('logoutModal')" class="close-button">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="text-center py-8">
                <div class="logout-icon">
                    <i class="fas fa-sign-out-alt"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800 mb-3" id="logoutUserName">আপনি কি লগআউট করতে চান?</h3>
                <p class="text-gray-600 mb-4" id="logoutUserRole">
                    আপনি বর্তমানে <span class="font-bold text-blue-600">এডমিন</span> হিসেবে লগইন আছেন
                </p>
                <p class="text-gray-500 text-sm">
                    লগআউট করলে আপনি ডাটাবেস এডিট করার সুযোগ হারাবেন। পুনরায় লগইন করতে আপনার ক্রেডেনশিয়াল প্রয়োজন হবে।
                </p>
                
                <div class="logout-buttons">
                    <button onclick="hideModal('logoutModal')" class="logout-btn logout-cancel">
                        <i class="fas fa-times mr-2"></i>বাতিল
                    </button>
                    <button onclick="performLogout()" class="logout-btn logout-confirm">
                        <i class="fas fa-sign-out-alt mr-2"></i>লগআউট
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- উন্নত মডেল ফরম - ছাত্র যোগ -->
    <div id="addStudentModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-user-graduate"></i>
                    <span id="studentModalTitle">নতুন ছাত্র/ছাত্রী যোগ করুন</span>
                </h3>
                <button onclick="hideModal('addStudentModal')" class="close-button">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-id-card"></i>প্রাথমিক তথ্য
                </h4>
                <div class="form-grid">
                    <div>
                        <label class="form-label">ছাত্র/ছাত্রীর নাম*</label>
                        <input id="studentName" type="text" class="form-input" placeholder="নাম লিখুন">
                    </div>
                    <div>
                        <label class="form-label">আইডি নং*</label>
                        <input id="studentIdNumber" type="text" class="form-input" placeholder="আইডি নং লিখুন">
                    </div>
                    <div>
                        <label class="form-label">রোল নং*</label>
                        <input id="studentRoll" type="number" class="form-input" placeholder="রোল নং লিখুন">
                    </div>
                    <div>
                        <label class="form-label">শ্রেণি*</label>
                        <select id="studentClass" class="form-input">
                            <option value="">শ্রেণি নির্বাচন করুন</option>
                            <option value="1">১ম শ্রেণি</option>
                            <option value="2">২য় শ্রেণি</option>
                            <option value="3">৩য় শ্রেণি</option>
                            <option value="4">৪র্থ শ্রেণি</option>
                            <option value="5">৫ম শ্রেণি</option>
                            <option value="6">৬ষ্ঠ শ্রেণি</option>
                            <option value="7">৭ম শ্রেণি</option>
                            <option value="8">৮ম শ্রেণি</option>
                            <option value="9">৯ম শ্রেণি</option>
                            <option value="10">১০ম শ্রেণি</option>
                            <option value="11">১১তম শ্রেণি</option>
                            <option value="12">১২তম শ্রেণি</option>
                        </select>
                    </div>
                    <div>
                        <label class="form-label">লিঙ্গ*</label>
                        <select id="studentGender" class="form-input">
                            <option value="">লিঙ্গ নির্বাচন করুন</option>
                            <option value="ছাত্র">ছাত্র</option>
                            <option value="ছাত্রী">ছাত্রী</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-users"></i>পরিবার তথ্য
                </h4>
                <div class="form-grid">
                    <div>
                        <label class="form-label">পিতার নাম*</label>
                        <input id="studentFather" type="text" class="form-input" placeholder="পিতার নাম লিখুন">
                    </div>
                    <div>
                        <label class="form-label">মাতার নাম*</label>
                        <input id="studentMother" type="text" class="form-input" placeholder="মাতার নাম লিখুন">
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-address-card"></i>যোগাযোগ তথ্য
                </h4>
                <div class="form-grid">
                    <div>
                        <label class="form-label">মোবাইল নম্বর</label>
                        <input id="studentMobile" type="tel" class="form-input" placeholder="মোবাইল নম্বর লিখুন">
                    </div>
                    <div>
                        <label class="form-label">ইমেইল</label>
                        <input id="studentEmail" type="email" class="form-input" placeholder="ইমেইল লিখুন">
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-map-marker-alt"></i>ঠিকানা তথ্য
                </h4>
                <div class="form-grid">
                    <div>
                        <label class="form-label">গ্রাম*</label>
                        <input id="studentVillage" type="text" class="form-input" placeholder="গ্রাম লিখুন">
                    </div>
                    <div>
                        <label class="form-label">উপজেলা*</label>
                        <input id="studentUpazila" type="text" class="form-input" placeholder="উপজেলা লিখুন">
                    </div>
                    <div>
                        <label class="form-label">জেলা*</label>
                        <input id="studentDistrict" type="text" class="form-input" placeholder="জেলা লিখুন">
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-calendar-alt"></i>ভর্তি তথ্য
                </h4>
                <div class="form-grid">
                    <div>
                        <label class="form-label">ভর্তির তারিখ</label>
                        <input id="studentAdmissionDate" type="date" class="form-input">
                    </div>
                </div>
            </div>
            
            <div class="mt-8 flex justify-end space-x-3">
                <button onclick="hideModal('addStudentModal')" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition duration-300 font-medium">
                    <i class="fas fa-times mr-2"></i>বাতিল
                </button>
                <button onclick="saveStudent()" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-300 font-medium shadow-md">
                    <i class="fas fa-save mr-2"></i>সংরক্ষণ করুন
                </button>
            </div>
        </div>
    </div>

    <!-- উন্নত মডেল ফরম - শিক্ষক যোগ -->
    <div id="addTeacherModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <span id="teacherModalTitle">নতুন শিক্ষক/কর্মচারী যোগ করুন</span>
                </h3>
                <button onclick="hideModal('addTeacherModal')" class="close-button">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-id-badge"></i>প্রাথমিক তথ্য
                </h4>
                <div class="form-grid">
                    <div>
                        <label class="form-label">নাম*</label>
                        <input id="teacherName" type="text" class="form-input" placeholder="নাম লিখুন">
                    </div>
                    <div>
                        <label class="form-label">ইনডেক্স নম্বর*</label>
                        <input id="teacherId" type="text" class="form-input" placeholder="ইনডেক্স নম্বর লিখুন">
                    </div>
                    <div>
                        <label class="form-label">পদবী*</label>
                        <select id="teacherDesignation" class="form-input">
                            <option value="">পদবী নির্বাচন করুন</option>
                            <option value="অধ্যক্ষ">অধ্যক্ষ</option>
                            <option value="উপাধ্যক্ষ">উপাধ্যক্ষ</option>
                            <option value="প্রভাষক">প্রভাষক</option>
                            <option value="সিনিয়র শিক্ষক">সিনিয়র শিক্ষক</option>
                            <option value="সহকারী শিক্ষক">সহকারী শিক্ষক</option>
                            <option value="সহকারী মৌলভী">সহকারী মৌলভী</option>
                            <option value="ইবতেদায়ী প্রধান">ইবতেদায়ী প্রধান</option>
                            <option value="জুনিয়র শিক্ষক">জুনিয়র শিক্ষক</option>
                            <option value="জুনিয়র মৌলভী">জুনিয়র মৌলভী</option>
                            <option value="ক্বারী">ক্বারী</option>
                            <option value="অফিস সহকারী">অফিস সহকারী</option>
                            <option value="কর্মচারী">কর্মচারী</option>
                            <option value="অন্যান্য">অন্যান্য</option>
                        </select>
                    </div>
                    <div>
                        <label class="form-label">বিষয়/দায়িত্ব</label>
                        <input id="teacherSubject" type="text" class="form-input" placeholder="বিষয়/দায়িত্ব লিখুন">
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-phone-alt"></i>যোগাযোগ তথ্য
                </h4>
                <div class="form-grid">
                    <div>
                        <label class="form-label">মোবাইল নম্বর*</label>
                        <input id="teacherMobile" type="tel" class="form-input" placeholder="মোবাইল নম্বর লিখুন">
                    </div>
                    <div>
                        <label class="form-label">ইমেইল</label>
                        <input id="teacherEmail" type="email" class="form-input" placeholder="ইমেইল লিখুন">
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-money-bill-wave"></i>আর্থিক তথ্য
                </h4>
                <div class="form-grid">
                    <div>
                        <label class="form-label">মাসিক বেতন*</label>
                        <input id="teacherSalary" type="number" class="form-input" placeholder="বেতন লিখুন">
                    </div>
                    <div>
                        <label class="form-label">জাতীয় পরিচয়পত্র নম্বর</label>
                        <input id="teacherNID" type="text" class="form-input" placeholder="এনআইডি নম্বর লিখুন">
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-calendar-check"></i>কর্মসংস্থান তথ্য
                </h4>
                <div class="form-grid">
                    <div>
                        <label class="form-label">যোগদান তারিখ*</label>
                        <input id="teacherJoiningDate" type="date" class="form-input">
                    </div>
                    <div>
                        <label class="form-label">প্রকার*</label>
                        <select id="teacherType" class="form-input">
                            <option value="">প্রকার নির্বাচন করুন</option>
                            <option value="শিক্ষক">শিক্ষক</option>
                            <option value="কর্মচারী">কর্মচারী</option>
                            <option value="অন্যান্য">অন্যান্য</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-home"></i>ঠিকানা তথ্য
                </h4>
                <div class="form-grid">
                    <div>
                        <label class="form-label">বর্তমান ঠিকানা*</label>
                        <input id="teacherAddress" type="text" class="form-input" placeholder="বর্তমান ঠিকানা লিখুন">
                    </div>
                    <div>
                        <label class="form-label">স্থায়ী ঠিকানা</label>
                        <input id="teacherPermanentAddress" type="text" class="form-input" placeholder="স্থায়ী ঠিকানা লিখুন">
                    </div>
                </div>
            </div>
            
            <div class="mt-8 flex justify-end space-x-3">
                <button onclick="hideModal('addTeacherModal')" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition duration-300 font-medium">
                    <i class="fas fa-times mr-2"></i>বাতিল
                </button>
                <button onclick="saveTeacher()" class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition duration-300 font-medium shadow-md">
                    <i class="fas fa-save mr-2"></i>সংরক্ষণ করুন
                </button>
            </div>
        </div>
    </div>

    <!-- হাজিরা যোগ করার মডেল -->
    <div id="addAttendanceModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-calendar-plus"></i>
                    <span id="attendanceModalTitle">নতুন হাজিরা যোগ করুন</span>
                </h3>
                <button onclick="hideModal('addAttendanceModal')" class="close-button">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-calendar-alt"></i>তারিখ ও সময় নির্বাচন
                </h4>
                <div class="form-grid">
                    <div>
                        <label class="form-label">তারিখ*</label>
                        <input id="attendanceDate" type="date" class="form-input" value="">
                    </div>
                    <div>
                        <label class="form-label">প্রবেশের সময়*</label>
                        <input id="attendanceInTime" type="time" class="form-input" value="09:00">
                    </div>
                    <div>
                        <label class="form-label">প্রস্থানের সময়</label>
                        <input id="attendanceOutTime" type="time" class="form-input" value="17:00">
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-user-tie"></i>শিক্ষক/কর্মচারী নির্বাচন
                </h4>
                <div class="form-grid">
                    <div>
                        <label class="form-label">শিক্ষক/কর্মচারী*</label>
                        <select id="attendanceTeacher" class="form-input" onchange="updateAttendanceDesignation()">
                            <option value="">নির্বাচন করুন</option>
                        </select>
                    </div>
                    <div>
                        <label class="form-label">পদবী</label>
                        <input id="attendanceDesignation" type="text" class="form-input" readonly>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-clipboard-check"></i>হাজিরার অবস্থা
                </h4>
                <div class="form-grid">
                    <div>
                        <label class="form-label">হাজিরার অবস্থা*</label>
                        <select id="attendanceStatus" class="form-input" onchange="toggleLeaveType()">
                            <option value="present">উপস্থিত</option>
                            <option value="absent">অনুপস্থিত</option>
                            <option value="late">বিলম্বিত</option>
                            <option value="leave">ছুটি</option>
                        </select>
                    </div>
                    <div id="leaveTypeContainer" class="hidden">
                        <label class="form-label">ছুটির ধরন</label>
                        <select id="attendanceLeaveType" class="form-input">
                            <option value="">নির্বাচন করুন</option>
                            <option value="sick">অসুস্থতা</option>
                            <option value="casual">অবসর</option>
                            <option value="emergency">জরুরী</option>
                            <option value="other">অন্যান্য</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-comment-dots"></i>অতিরিক্ত তথ্য
                </h4>
                <div class="form-grid">
                    <div class="col-span-2">
                        <label class="form-label">মন্তব্য</label>
                        <textarea id="attendanceComments" class="form-input" rows="3" placeholder="কোন বিশেষ মন্তব্য থাকলে লিখুন..."></textarea>
                    </div>
                </div>
            </div>
            
            <div class="mt-8 flex justify-end space-x-3">
                <button onclick="hideModal('addAttendanceModal')" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition duration-300 font-medium">
                    <i class="fas fa-times mr-2"></i>বাতিল
                </button>
                <button onclick="saveAttendance()" class="px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition duration-300 font-medium shadow-md">
                    <i class="fas fa-save mr-2"></i>সংরক্ষণ করুন
                </button>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDaZADzHPZ_9lsWZKCkxFxo9WpI2cg81p8",
            authDomain: "madrasa-management-18752.firebaseapp.com",
            databaseURL: "https://madrasa-management-18752-default-rtdb.firebaseio.com",
            projectId: "madrasa-management-18752",
            storageBucket: "madrasa-management-18752.firebasestorage.app",
            messagingSenderId: "917070576930",
            appId: "1:917070576930:web:8544eadbd3edb22ef7b97b",
            measurementId: "G-CPK42V81YC"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const auth = firebase.auth();

        // ডেটা স্টোরেজ
        let students = [];
        let teachers = [];
        let transactions = [];
        let attendanceRecords = [];
        let currentUser = null;
        let currentStudentEditId = null;
        let currentTeacherEditId = null;
        let currentAttendanceEditId = null;
        let selectedRole = 'admin'; // ডিফল্ট এডমিন সিলেক্টেড
        let passwordHintVisible = false; // পাসওয়ার্ড হিন্ট দৃশ্যমান কিনা

        // বাংলা সংখ্যা কনভার্টার
        const banglaNumbers = ['০', '১', '২', '৩', '৪', '৫', '৬', '৭', '৮', '৯'];
        
        function toBanglaNumber(num) {
            if (num === undefined || num === null) return '০';
            return num.toString().split('').map(digit => {
                if (digit >= '0' && digit <= '9') {
                    return banglaNumbers[parseInt(digit)];
                }
                return digit;
            }).join('');
        }

        // বাংলা তারিখ ফরম্যাট
        const banglaMonths = [
            'জানুয়ারী', 'ফেব্রুয়ারী', 'মার্চ', 'এপ্রিল', 'মে', 'জুন',
            'জুলাই', 'আগস্ট', 'সেপ্টেম্বর', 'অক্টোবর', 'নভেম্বর', 'ডিসেম্বর'
        ];
        
        const banglaDays = [
            'রবিবার', 'সোমবার', 'মঙ্গলবার', 'বুধবার', 'বৃহস্পতিবার', 'শুক্রবার', 'শনিবার'
        ];

        function updateBanglaDate() {
            const now = new Date();
            const day = banglaDays[now.getDay()];
            const date = now.getDate();
            const month = banglaMonths[now.getMonth()];
            const year = now.getFullYear();
            
            document.getElementById('currentDateBangla').textContent = 
                `${day}, ${toBanglaNumber(date)} ${month} ${toBanglaNumber(year)}`;
            
            const time = now.toLocaleTimeString('bn-BD');
            document.getElementById('currentTime').textContent = time;
        }

        // নোটিফিকেশন শো করা
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            notification.className = `notification notification-${type}`;
            notification.classList.remove('hidden');
            
            // 3 সেকেন্ড পর অটোমেটিক হাইড
            setTimeout(() => {
                notification.classList.add('hidden');
            }, 3000);
        }

        // রোল সিলেক্ট
        function selectRole(role) {
            selectedRole = role;
            
            // UI আপডেট
            const adminOption = document.getElementById('adminRole');
            const userOption = document.getElementById('userRole');
            
            if (role === 'admin') {
                adminOption.classList.add('active');
                userOption.classList.remove('active');
                document.getElementById('currentRoleTitle').textContent = 'এডমিন লগইন:';
                
                // শুধু ইমেইল দেখাবে, পাসওয়ার্ড দেখাবে না
                document.getElementById('currentRoleCreds').innerHTML = 'ইমেইল: admin@madrasa.com';
                
                // ইমেইল অটো ফিল
                document.getElementById('loginEmail').value = 'admin@madrasa.com';
                // পাসওয়ার্ড খালি রাখবে
                document.getElementById('loginPassword').value = '';
                
                // পাসওয়ার্ড প্লেসহোল্ডার
                document.getElementById('loginPassword').placeholder = 'এডমিন পাসওয়ার্ড লিখুন';
            } else {
                userOption.classList.add('active');
                adminOption.classList.remove('active');
                document.getElementById('currentRoleTitle').textContent = 'ইউজার লগইন:';
                
                // শুধু ইমেইল দেখাবে, পাসওয়ার্ড দেখাবে না
                document.getElementById('currentRoleCreds').innerHTML = 'ইমেইল: user@madrasa.com';
                
                // ইমেইল অটো ফিল
                document.getElementById('loginEmail').value = 'user@madrasa.com';
                // পাসওয়ার্ড খালি রাখবে
                document.getElementById('loginPassword').value = '';
                
                // পাসওয়ার্ড প্লেসহোল্ডার
                document.getElementById('loginPassword').placeholder = 'ইউজার পাসওয়ার্ড লিখুন';
            }
        }

        // পাসওয়ার্ড হিন্ট টগল
        function togglePasswordHint() {
            passwordHintVisible = !passwordHintVisible;
            const showPasswordBtn = document.getElementById('showPasswordBtn');
            
            if (passwordHintVisible) {
                showPasswordBtn.innerHTML = '<i class="fas fa-eye-slash mr-1"></i>পাসওয়ার্ড লুকান';
                
                // পাসওয়ার্ড হিন্ট দেখাও
                if (selectedRole === 'admin') {
                    document.getElementById('currentRoleCreds').innerHTML = 
                        'ইমেইল: admin@madrasa.com | পাসওয়ার্ড: password123';
                } else {
                    document.getElementById('currentRoleCreds').innerHTML = 
                        'ইমেইল: user@madrasa.com | পাসওয়ার্ড: viewer123';
                }
            } else {
                showPasswordBtn.innerHTML = '<i class="fas fa-key mr-1"></i>পাসওয়ার্ড দেখুন';
                
                // পাসওয়ার্ড হিন্ট লুকাও
                if (selectedRole === 'admin') {
                    document.getElementById('currentRoleCreds').innerHTML = 
                        'ইমেইল: admin@madrasa.com';
                } else {
                    document.getElementById('currentRoleCreds').innerHTML = 
                        'ইমেইল: user@madrasa.com';
                }
            }
        }

        // ইউজার রোল অনুযায়ী UI কন্ট্রোল
        function updateUIForUserRole() {
            const isAdmin = currentUser && currentUser.role === 'admin';
            const isViewer = currentUser && currentUser.role === 'viewer';
            
            // রোল বাজ দেখাও
            const roleBadge = document.getElementById('userRoleBadge');
            if (isAdmin) {
                roleBadge.className = 'user-badge admin-badge';
                roleBadge.textContent = 'এডমিন';
                showNotification('এডমিন হিসেবে লগইন সফল!', 'success');
            } else if (isViewer) {
                roleBadge.className = 'user-badge user-badge-normal';
                roleBadge.textContent = 'ইউজার';
                showNotification('ইউজার হিসেবে লগইন সফল!', 'success');
            }
            
            // এডিট বাটন কন্ট্রোল
            const addStudentBtn = document.getElementById('addStudentBtn');
            const addTeacherBtn = document.getElementById('addTeacherBtn');
            const addAttendanceBtn = document.getElementById('addAttendanceBtn');
            const financeForm = document.getElementById('financeForm');
            
            if (isAdmin) {
                addStudentBtn.classList.remove('hidden');
                addTeacherBtn.classList.remove('hidden');
                addAttendanceBtn.classList.remove('hidden');
                financeForm.classList.remove('hidden');
            } else {
                addStudentBtn.classList.add('hidden');
                addTeacherBtn.classList.add('hidden');
                addAttendanceBtn.classList.add('hidden');
                financeForm.classList.add('hidden');
            }
        }

        // Firebase থেকে ডেটা লোড
        function loadDataFromFirebase() {
            // ছাত্র ডেটা
            database.ref('madrasa_18752/students').on('value', (snapshot) => {
                students = [];
                snapshot.forEach((childSnapshot) => {
                    students.push({ id: childSnapshot.key, ...childSnapshot.val() });
                });
                loadStudents();
                updateDashboard();
                updateSyncStatus('ডেটা সিঙ্ক হয়েছে');
            });

            // শিক্ষক ডেটা
            database.ref('madrasa_18752/teachers').on('value', (snapshot) => {
                teachers = [];
                snapshot.forEach((childSnapshot) => {
                    teachers.push({ id: childSnapshot.key, ...childSnapshot.val() });
                });
                loadTeachers();
                updateDashboard();
                updateSyncStatus('ডেটা সিঙ্ক হয়েছে');
            });

            // লেনদেন ডেটা
            database.ref('madrasa_18752/transactions').on('value', (snapshot) => {
                transactions = [];
                snapshot.forEach((childSnapshot) => {
                    transactions.push({ id: childSnapshot.key, ...childSnapshot.val() });
                });
                loadFinancialData();
                updateDashboard();
                updateSyncStatus('ডেটা সিঙ্ক হয়েছে');
            });

            // হাজিরা ডেটা
            database.ref('madrasa_18752/attendance').on('value', (snapshot) => {
                attendanceRecords = [];
                snapshot.forEach((childSnapshot) => {
                    attendanceRecords.push({ id: childSnapshot.key, ...childSnapshot.val() });
                });
                loadAttendanceTable();
                updateAttendanceSummary();
                updateSyncStatus('হাজিরা ডেটা সিঙ্ক হয়েছে');
            });
        }

        function updateSyncStatus(message) {
            const syncStatus = document.getElementById('syncStatus');
            if (syncStatus) {
                syncStatus.textContent = message;
                syncStatus.className = 'text-xs mt-1 text-green-600 font-medium';
                setTimeout(() => {
                    syncStatus.className = 'text-xs mt-1 text-gray-600';
                }, 3000);
            }
        }

        // Firebase এ ডেটা সেভ
        function saveToFirebase(type, data, id = null) {
            updateSyncStatus('ডেটা সেভ হচ্ছে...');
            const path = `madrasa_18752/${type}`;
            
            if (id) {
                // এডিট
                return database.ref(`${path}/${id}`).update(data)
                    .then(() => {
                        updateSyncStatus('ডেটা আপডেট হয়েছে');
                        return true;
                    })
                    .catch(error => {
                        updateSyncStatus('ত্রুটি: ' + error.message);
                        return false;
                    });
            } else {
                // নিউ
                const newId = database.ref(path).push().key;
                return database.ref(`${path}/${newId}`).set({ ...data, id: newId })
                    .then(() => {
                        updateSyncStatus('ডেটা যোগ হয়েছে');
                        return true;
                    })
                    .catch(error => {
                        updateSyncStatus('ত্রুটি: ' + error.message);
                        return false;
                    });
            }
        }

        // Firebase থেকে ডিলিট
        function deleteFromFirebase(type, id) {
            updateSyncStatus('ডেটা মুছে ফেলা হচ্ছে...');
            return database.ref(`madrasa_18752/${type}/${id}`).remove()
                .then(() => {
                    updateSyncStatus('ডেটা মুছে ফেলা হয়েছে');
                    return true;
                })
                .catch(error => {
                    updateSyncStatus('ত্রুটি: ' + error.message);
                    return false;
                });
        }

        // লগইন সিস্টেম
        function login() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            const loginBtn = document.getElementById('loginBtn');
            const originalText = loginBtn.innerHTML;
            
            // ভ্যালিডেশন চেক
            if (!email || !password) {
                showNotification('দয়া করে ইমেইল ও পাসওয়ার্ড দিন!', 'error');
                return;
            }
            
            // লোডিং স্টেট
            loginBtn.innerHTML = '<div class="loading"></div> লগইন হচ্ছে...';
            loginBtn.disabled = true;
            
            // ডিফল্ট এডমিন লগইন
            const defaultAdmin = {
                email: 'admin@madrasa.com',
                password: 'password123',
                role: 'admin',
                name: 'সিস্টেম এডমিন'
            };
            
            const defaultViewer = {
                email: 'user@madrasa.com',
                password: 'viewer123',
                role: 'viewer',
                name: 'সিস্টেম ইউজার'
            };
            
            // 1 সেকেন্ড ডিলে (ইউএক্সের জন্য)
            setTimeout(() => {
                // নির্বাচিত রোল অনুযায়ী চেক
                if (selectedRole === 'admin') {
                    if (email === defaultAdmin.email && password === defaultAdmin.password) {
                        currentUser = defaultAdmin;
                        handleSuccessfulLogin();
                    } else {
                        showNotification('ভুল এডমিন ইমেইল বা পাসওয়ার্ড!', 'error');
                    }
                } else if (selectedRole === 'user') {
                    if (email === defaultViewer.email && password === defaultViewer.password) {
                        currentUser = defaultViewer;
                        handleSuccessfulLogin();
                    } else {
                        showNotification('ভুল ইউজার ইমেইল বা পাসওয়ার্ড!', 'error');
                    }
                }
                
                // বাটন রিসেট
                loginBtn.innerHTML = originalText;
                loginBtn.disabled = false;
            }, 1000);
        }

        function handleSuccessfulLogin() {
            try {
                // লগইন মডেল লুকাও
                const loginModal = document.getElementById('loginModal');
                if (loginModal) {
                    loginModal.style.display = 'none';
                    loginModal.classList.add('hidden');
                }
                
                // পাসওয়ার্ড হিন্ট বাটন লুকাও
                document.getElementById('showPasswordBtn').style.display = 'none';
                
                // অ্যাপ কন্টেন্ট দেখাও
                const appContent = document.getElementById('appContent');
                if (appContent) {
                    appContent.classList.remove('hidden');
                }
                
                // UI আপডেট
                updateUIForUserRole();
                
                // Firebase থেকে ডেটা লোড
                loadDataFromFirebase();
                
                // ড্যাশবোর্ড দেখাও
                showSection('dashboard');
                
                // তারিখ আপডেট শুরু করো
                updateBanglaDate();
                setInterval(updateBanglaDate, 60000);
                
                // রিমেমবার মি চেকবক্স
                const rememberMe = document.getElementById('rememberMe');
                if (rememberMe && rememberMe.checked) {
                    localStorage.setItem('rememberedEmail', currentUser.email);
                    localStorage.setItem('rememberedRole', currentUser.role);
                } else {
                    localStorage.removeItem('rememberedEmail');
                    localStorage.removeItem('rememberedRole');
                }
                
            } catch (error) {
                console.error("Error in handleSuccessfulLogin:", error);
                showNotification('লগইন প্রসেসে সমস্যা হয়েছে। পেজ রিফ্রেশ করুন।', 'error');
            }
        }

        // লগআউট কনফার্মেশন দেখাও
        function showLogoutConfirm() {
            if (!currentUser) return;
            
            const logoutUserName = document.getElementById('logoutUserName');
            const logoutUserRole = document.getElementById('logoutUserRole');
            
            if (currentUser.role === 'admin') {
                logoutUserName.textContent = `${currentUser.name}, আপনি কি লগআউট করতে চান?`;
                logoutUserRole.innerHTML = 'আপনি বর্তমানে <span class="font-bold text-blue-600">এডমিন</span> হিসেবে লগইন আছেন';
            } else {
                logoutUserName.textContent = `${currentUser.name}, আপনি কি লগআউট করতে চান?`;
                logoutUserRole.innerHTML = 'আপনি বর্তমানে <span class="font-bold text-green-600">ইউজার</span> হিসেবে লগইন আছেন';
            }
            
            document.getElementById('logoutModal').classList.remove('hidden');
        }

        // লগআউট এক্সিকিউট
        function performLogout() {
            hideModal('logoutModal');
            
            // অ্যাপ কন্টেন্ট লুকাও
            document.getElementById('appContent').classList.add('hidden');
            
            // লগইন মডেল দেখাও
            const loginModal = document.getElementById('loginModal');
            if (loginModal) {
                loginModal.style.display = 'flex';
                loginModal.classList.remove('hidden');
            }
            
            // পাসওয়ার্ড হিন্ট বাটন দেখাও
            document.getElementById('showPasswordBtn').style.display = 'block';
            
            // ফর্ম রিসেট (শুধু পাসওয়ার্ড)
            document.getElementById('loginPassword').value = '';
            
            // রোল সিলেক্টর রিসেট
            selectRole('admin');
            
            // রিমেমবার মি চেকবক্স আনচেক
            document.getElementById('rememberMe').checked = false;
            
            // ইউজার রিসেট
            const previousUser = currentUser;
            currentUser = null;
            
            showNotification(`${previousUser.name} হিসেবে সফলভাবে লগআউট হয়েছে!`, 'success');
        }

        // ট্যাব নেভিগেশন
        function showSection(sectionId) {
            // সব সেকশন লুকাও
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.add('hidden');
            });
            
            // সব ট্যাব অ্যাক্টিভ ক্লাস রিমুভ
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // নির্বাচিত সেকশন দেখাও
            const section = document.getElementById(`section-${sectionId}`);
            if (section) {
                section.classList.remove('hidden');
            }
            
            // নির্বাচিত ট্যাব অ্যাক্টিভ করো
            const tab = document.getElementById(`tab-${sectionId}`);
            if (tab) {
                tab.classList.add('active');
            }
        }

        // পাসওয়ার্ড টগল
        function togglePassword() {
            const passwordInput = document.getElementById('loginPassword');
            const toggleBtn = document.querySelector('.toggle-password i');
            
            if (passwordInput && toggleBtn) {
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    toggleBtn.className = 'fas fa-eye-slash';
                } else {
                    passwordInput.type = 'password';
                    toggleBtn.className = 'fas fa-eye';
                }
            }
        }

        // ফরগট পাসওয়ার্ড
        function showForgotPassword() {
            const message = selectedRole === 'admin' 
                ? 'এডমিন পাসওয়ার্ড ভুলে গেছেন? অ্যাডমিনের সাথে যোগাযোগ করুন: ০১৭১১-১৮৬০৮১'
                : 'ইউজার পাসওয়ার্ড ভুলে গেছেন? অ্যাডমিনের সাথে যোগাযোগ করুন: ০১৭১১-১৮৬০৮১';
            showNotification(message, 'info');
        }

        // মডেল কন্ট্রোল
        function showAddStudentModal() {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('শুধুমাত্র এডমিন এই ফিচার ব্যবহার করতে পারেন!', 'error');
                return;
            }
            document.getElementById('addStudentModal').classList.remove('hidden');
            currentStudentEditId = null;
            resetStudentForm();
            document.getElementById('studentModalTitle').textContent = 'নতুন ছাত্র/ছাত্রী যোগ করুন';
        }

        function showEditStudentModal(studentId) {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('শুধুমাত্র এডমিন এই ফিচার ব্যবহার করতে পারেন!', 'error');
                return;
            }
            
            const student = students.find(s => s.id === studentId);
            if (student) {
                currentStudentEditId = studentId;
                
                document.getElementById('studentName').value = student.name;
                document.getElementById('studentRoll').value = student.roll;
                document.getElementById('studentClass').value = student.class;
                document.getElementById('studentGender').value = student.gender;
                document.getElementById('studentFather').value = student.fatherName;
                document.getElementById('studentMother').value = student.motherName;
                document.getElementById('studentIdNumber').value = student.studentIdNumber || '';
                document.getElementById('studentMobile').value = student.mobile;
                document.getElementById('studentEmail').value = student.email;
                document.getElementById('studentVillage').value = student.village;
                document.getElementById('studentUpazila').value = student.upazila;
                document.getElementById('studentDistrict').value = student.district;
                document.getElementById('studentAdmissionDate').value = student.admissionDate;
                
                document.getElementById('studentModalTitle').textContent = 'ছাত্র/ছাত্রী তথ্য এডিট করুন';
                document.getElementById('addStudentModal').classList.remove('hidden');
            }
        }

        function resetStudentForm() {
            document.getElementById('studentName').value = '';
            document.getElementById('studentRoll').value = '';
            document.getElementById('studentClass').value = '';
            document.getElementById('studentGender').value = '';
            document.getElementById('studentFather').value = '';
            document.getElementById('studentMother').value = '';
            document.getElementById('studentIdNumber').value = '';
            document.getElementById('studentMobile').value = '';
            document.getElementById('studentEmail').value = '';
            document.getElementById('studentVillage').value = '';
            document.getElementById('studentUpazila').value = '';
            document.getElementById('studentDistrict').value = '';
            document.getElementById('studentAdmissionDate').value = new Date().toISOString().split('T')[0];
        }

        function showAddTeacherModal() {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('শুধুমাত্র এডমিন এই ফিচার ব্যবহার করতে পারেন!', 'error');
                return;
            }
            document.getElementById('addTeacherModal').classList.remove('hidden');
            currentTeacherEditId = null;
            resetTeacherForm();
            document.getElementById('teacherModalTitle').textContent = 'নতুন শিক্ষক/কর্মচারী যোগ করুন';
        }

        function showEditTeacherModal(teacherId) {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('শুধুমাত্র এডমিন এই ফিচার ব্যবহার করতে পারেন!', 'error');
                return;
            }
            
            const teacher = teachers.find(t => t.id === teacherId);
            if (teacher) {
                currentTeacherEditId = teacherId;
                
                document.getElementById('teacherName').value = teacher.name;
                document.getElementById('teacherId').value = teacher.teacherId;
                document.getElementById('teacherDesignation').value = teacher.designation;
                document.getElementById('teacherSubject').value = teacher.subject;
                document.getElementById('teacherMobile').value = teacher.mobile;
                document.getElementById('teacherEmail').value = teacher.email;
                document.getElementById('teacherSalary').value = teacher.salary;
                document.getElementById('teacherJoiningDate').value = teacher.joiningDate;
                document.getElementById('teacherNID').value = teacher.nid;
                document.getElementById('teacherAddress').value = teacher.address;
                document.getElementById('teacherPermanentAddress').value = teacher.permanentAddress;
                document.getElementById('teacherType').value = teacher.type;
                
                document.getElementById('teacherModalTitle').textContent = 'শিক্ষক/কর্মচারী তথ্য এডিট করুন';
                document.getElementById('addTeacherModal').classList.remove('hidden');
            }
        }

        function resetTeacherForm() {
            document.getElementById('teacherName').value = '';
            document.getElementById('teacherId').value = '';
            document.getElementById('teacherDesignation').value = '';
            document.getElementById('teacherSubject').value = '';
            document.getElementById('teacherMobile').value = '';
            document.getElementById('teacherEmail').value = '';
            document.getElementById('teacherSalary').value = '';
            document.getElementById('teacherJoiningDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('teacherNID').value = '';
            document.getElementById('teacherAddress').value = '';
            document.getElementById('teacherPermanentAddress').value = '';
            document.getElementById('teacherType').value = '';
        }

        // হাজিরা মডেল দেখাও
        function showAttendanceModal() {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('শুধুমাত্র এডমিন এই ফিচার ব্যবহার করতে পারেন!', 'error');
                return;
            }
            
            document.getElementById('addAttendanceModal').classList.remove('hidden');
            currentAttendanceEditId = null;
            resetAttendanceForm();
            loadTeacherOptions();
            document.getElementById('attendanceModalTitle').textContent = 'নতুন হাজিরা যোগ করুন';
            
            // আজকের তারিখ সেট করুন
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('attendanceDate').value = today;
        }

        // শিক্ষক অপশন লোড
        function loadTeacherOptions() {
            const select = document.getElementById('attendanceTeacher');
            select.innerHTML = '<option value="">নির্বাচন করুন</option>';
            
            teachers.forEach(teacher => {
                const option = document.createElement('option');
                option.value = teacher.id;
                option.textContent = `${teacher.name} - ${teacher.designation}`;
                option.setAttribute('data-designation', teacher.designation);
                select.appendChild(option);
            });
        }

        // পদবী আপডেট
        function updateAttendanceDesignation() {
            const select = document.getElementById('attendanceTeacher');
            const selectedOption = select.options[select.selectedIndex];
            const designation = selectedOption.getAttribute('data-designation') || '';
            document.getElementById('attendanceDesignation').value = designation;
        }

        // ছুটির ধরন টগল
        function toggleLeaveType() {
            const status = document.getElementById('attendanceStatus').value;
            const leaveTypeContainer = document.getElementById('leaveTypeContainer');
            
            if (status === 'leave') {
                leaveTypeContainer.classList.remove('hidden');
            } else {
                leaveTypeContainer.classList.add('hidden');
                document.getElementById('attendanceLeaveType').value = '';
            }
        }

        // হাজিরা ফর্ম রিসেট
        function resetAttendanceForm() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('attendanceDate').value = today;
            document.getElementById('attendanceInTime').value = '09:00';
            document.getElementById('attendanceOutTime').value = '17:00';
            document.getElementById('attendanceTeacher').value = '';
            document.getElementById('attendanceDesignation').value = '';
            document.getElementById('attendanceStatus').value = 'present';
            document.getElementById('attendanceLeaveType').value = '';
            document.getElementById('attendanceComments').value = '';
            document.getElementById('leaveTypeContainer').classList.add('hidden');
        }

        function hideModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        // ছাত্র ডেটা ম্যানেজমেন্ট
        function saveStudent() {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('শুধুমাত্র এডমিন এই ফিচার ব্যবহার করতে পারেন!', 'error');
                return;
            }
            
            const name = document.getElementById('studentName').value.trim();
            const roll = document.getElementById('studentRoll').value.trim();
            const studentClass = document.getElementById('studentClass').value;
            const gender = document.getElementById('studentGender').value;
            const fatherName = document.getElementById('studentFather').value.trim();
            const motherName = document.getElementById('studentMother').value.trim();
            const studentIdNumber = document.getElementById('studentIdNumber').value.trim();
            
            // ভ্যালিডেশন
            if (!name || !roll || !studentClass || !gender || !fatherName || !motherName || !studentIdNumber) {
                showNotification('দয়া করে সকল প্রয়োজনীয় তথ্য প্রদান করুন (* চিহ্নিত ফিল্ড)', 'error');
                return;
            }
            
            // নতুন ছাত্র যোগ করার সময় ইউনিক আইডি চেক
            if (currentStudentEditId === null) {
                const existingStudent = students.find(s => s.studentIdNumber === studentIdNumber);
                if (existingStudent) {
                    showNotification('এই আইডি নং ইতিমধ্যে ব্যবহার করা হয়েছে!', 'error');
                    return;
                }
            }
            
            const studentData = {
                name,
                roll: parseInt(roll),
                class: studentClass,
                gender,
                fatherName,
                motherName,
                studentIdNumber,
                mobile: document.getElementById('studentMobile').value.trim(),
                email: document.getElementById('studentEmail').value.trim(),
                village: document.getElementById('studentVillage').value.trim(),
                upazila: document.getElementById('studentUpazila').value.trim(),
                district: document.getElementById('studentDistrict').value.trim(),
                admissionDate: document.getElementById('studentAdmissionDate').value,
                createdAt: new Date().toISOString(),
                updatedBy: currentUser.email
            };
            
            saveToFirebase('students', studentData, currentStudentEditId)
                .then(success => {
                    if (success) {
                        hideModal('addStudentModal');
                        showNotification(currentStudentEditId ? 'ছাত্র তথ্য আপডেট করা হয়েছে!' : 'নতুন ছাত্র যোগ করা হয়েছে!', 'success');
                    }
                });
        }

        function deleteStudent(studentId) {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('শুধুমাত্র এডমিন এই ফিচার ব্যবহার করতে পারেন!', 'error');
                return;
            }
            
            if (confirm('আপনি কি এই ছাত্র/ছাত্রীর তথ্য মুছতে চান?')) {
                deleteFromFirebase('students', studentId)
                    .then(success => {
                        if (success) {
                            showNotification('ছাত্র/ছাত্রীর তথ্য মুছে ফেলা হয়েছে!', 'success');
                        }
                    });
            }
        }

        function loadStudents() {
            const tbody = document.getElementById('studentTableBody');
            const emptyState = document.getElementById('emptyStudents');
            
            if (students.length === 0) {
                tbody.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }
            
            emptyState.classList.add('hidden');
            
            const filteredStudents = filterStudentsList();
            
            tbody.innerHTML = filteredStudents.map((student, index) => `
                <tr class="border-b hover:bg-gray-50 transition duration-200">
                    <td class="p-4">
                        <div class="index-badge">${toBanglaNumber(index + 1)}</div>
                    </td>
                    <td class="p-4 font-bold text-gray-800">${student.studentIdNumber ? toBanglaNumber(student.studentIdNumber) : toBanglaNumber(student.id.substring(0, 5))}</td>
                    <td class="p-4 font-bold text-gray-800">${toBanglaNumber(student.roll)}</td>
                    <td class="p-4">
                        <div class="font-semibold text-gray-800">${student.name}</div>
                        <div class="text-sm text-gray-500">${student.gender}</div>
                    </td>
                    <td class="p-4">
                        <span class="px-3 py-1.5 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">
                            ${toBanglaNumber(student.class)}ম শ্রেণি
                        </span>
                    </td>
                    <td class="p-4 text-gray-700">${student.fatherName}</td>
                    <td class="p-4 text-gray-700">${student.motherName}</td>
                    <td class="p-4 text-gray-700">${student.mobile || 'N/A'}</td>
                    <td class="p-4 text-gray-700">${student.village}</td>
                    <td class="p-4">
                        ${currentUser && currentUser.role === 'admin' ? `
                            <button onclick="showEditStudentModal('${student.id}')" class="text-blue-600 hover:text-blue-800 mr-3 p-2 rounded-lg hover:bg-blue-50 transition duration-200">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteStudent('${student.id}')" class="text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50 transition duration-200">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        ` : `
                            <span class="text-gray-400 text-sm">শুধুমাত্র দেখুন</span>
                        `}
                    </td>
                </tr>
            `).join('');
        }

        function filterStudents() {
            loadStudents();
        }

        function filterStudentsList() {
            const filterClass = document.getElementById('filterClass').value;
            const searchTerm = document.getElementById('searchStudent').value.toLowerCase();
            
            let filtered = students;
            
            if (filterClass) {
                filtered = filtered.filter(s => s.class === filterClass);
            }
            
            if (searchTerm) {
                filtered = filtered.filter(s => 
                    s.name.toLowerCase().includes(searchTerm) ||
                    s.fatherName.toLowerCase().includes(searchTerm) ||
                    s.motherName.toLowerCase().includes(searchTerm) ||
                    s.roll.toString().includes(searchTerm) ||
                    (s.studentIdNumber && s.studentIdNumber.includes(searchTerm))
                );
            }
            
            return filtered;
        }

        // শিক্ষক ডেটা ম্যানেজমেন্ট
        function saveTeacher() {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('শুধুমাত্র এডমিন এই ফিচার ব্যবহার করতে পারেন!', 'error');
                return;
            }
            
            const name = document.getElementById('teacherName').value.trim();
            const teacherId = document.getElementById('teacherId').value.trim();
            const designation = document.getElementById('teacherDesignation').value;
            const mobile = document.getElementById('teacherMobile').value.trim();
            const salary = document.getElementById('teacherSalary').value;
            const joiningDate = document.getElementById('teacherJoiningDate').value;
            const type = document.getElementById('teacherType').value;
            
            // ভ্যালিডেশন
            if (!name || !teacherId || !designation || !mobile || !salary || !joiningDate || !type) {
                showNotification('দয়া করে সকল প্রয়োজনীয় তথ্য প্রদান করুন (* চিহ্নিত ফিল্ড)', 'error');
                return;
            }
            
            const teacherData = {
                name,
                teacherId,
                designation,
                subject: document.getElementById('teacherSubject').value.trim(),
                mobile,
                email: document.getElementById('teacherEmail').value.trim(),
                salary: parseFloat(salary),
                joiningDate,
                nid: document.getElementById('teacherNID').value.trim(),
                address: document.getElementById('teacherAddress').value.trim(),
                permanentAddress: document.getElementById('teacherPermanentAddress').value.trim(),
                type,
                createdAt: new Date().toISOString(),
                updatedBy: currentUser.email
            };
            
            saveToFirebase('teachers', teacherData, currentTeacherEditId)
                .then(success => {
                    if (success) {
                        hideModal('addTeacherModal');
                        showNotification(currentTeacherEditId ? 'শিক্ষক তথ্য আপডেট করা হয়েছে!' : 'নতুন শিক্ষক যোগ করা হয়েছে!', 'success');
                    }
                });
        }

        function deleteTeacher(teacherId) {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('শুধুমাত্র এডমিন এই ফিচার ব্যবহার করতে পারেন!', 'error');
                return;
            }
            
            if (confirm('আপনি কি এই শিক্ষক/কর্মচারীর তথ্য মুছতে চান?')) {
                deleteFromFirebase('teachers', teacherId)
                    .then(success => {
                        if (success) {
                            showNotification('শিক্ষক/কর্মচারীর তথ্য মুছে ফেলা হয়েছে!', 'success');
                        }
                    });
            }
        }

        function loadTeachers() {
            const tbody = document.getElementById('teacherTableBody');
            const emptyState = document.getElementById('emptyTeachers');
            
            if (teachers.length === 0) {
                tbody.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }
            
            emptyState.classList.add('hidden');
            
            tbody.innerHTML = teachers.map((teacher, index) => `
                <tr class="border-b hover:bg-gray-50 transition duration-200">
                    <td class="p-4">
                        <div class="index-badge">${toBanglaNumber(index + 1)}</div>
                    </td>
                    <td class="p-4 font-bold text-gray-800">${teacher.teacherId}</td>
                    <td class="p-4 font-semibold text-gray-800">${teacher.name}</td>
                    <td class="p-4">
                        <span class="px-3 py-1.5 bg-purple-100 text-purple-800 rounded-full text-sm font-medium">
                            ${teacher.designation}
                        </span>
                    </td>
                    <td class="p-4 text-gray-700">${teacher.subject || 'N/A'}</td>
                    <td class="p-4 text-gray-700">${teacher.mobile}</td>
                    <td class="p-4 text-gray-700">${teacher.nid || 'N/A'}</td>
                    <td class="p-4 font-bold text-gray-800">৳ ${toBanglaNumber(teacher.salary.toLocaleString('bn-BD'))}</td>
                    <td class="p-4 text-gray-700">${new Date(teacher.joiningDate).toLocaleDateString('bn-BD')}</td>
                    <td class="p-4">
                        ${currentUser && currentUser.role === 'admin' ? `
                            <button onclick="showEditTeacherModal('${teacher.id}')" class="text-blue-600 hover:text-blue-800 mr-3 p-2 rounded-lg hover:bg-blue-50 transition duration-200">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteTeacher('${teacher.id}')" class="text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50 transition duration-200">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        ` : `
                            <span class="text-gray-400 text-sm">শুধুমাত্র দেখুন</span>
                        `}
                    </td>
                </tr>
            `).join('');
        }

        // আর্থিক ডেটা ম্যানেজমেন্ট
        function addFinancialTransaction() {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('শুধুমাত্র এডমিন এই ফিচার ব্যবহার করতে পারেন!', 'error');
                return;
            }
            
            const desc = document.getElementById('financeDesc').value.trim();
            const amount = parseFloat(document.getElementById('financeAmount').value);
            const type = document.getElementById('financeType').value;
            const date = document.getElementById('financeDate').value || new Date().toISOString().split('T')[0];
            
            if(!desc || !amount || amount <= 0) {
                showNotification("দয়া করে সঠিক তথ্য দিন!", "error");
                return;
            }
            
            const transactionData = { 
                desc, 
                amount, 
                type,
                date,
                timestamp: new Date().toISOString(),
                addedBy: currentUser.email
            };
            
            saveToFirebase('transactions', transactionData)
                .then(success => {
                    if (success) {
                        // ফর্ম রিসেট
                        document.getElementById('financeDesc').value = '';
                        document.getElementById('financeAmount').value = '';
                        document.getElementById('financeDate').value = new Date().toISOString().split('T')[0];
                        showNotification('লেনদেন যোগ করা হয়েছে!', 'success');
                    }
                });
        }

        function deleteTransaction(id) {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('শুধুমাত্র এডমিন এই ফিচার ব্যবহার করতে পারেন!', 'error');
                return;
            }
            
            if(confirm('আপনি কি এই লেনদেনটি মুছতে চান?')) {
                deleteFromFirebase('transactions', id)
                    .then(success => {
                        if (success) {
                            showNotification('লেনদেন মুছে ফেলা হয়েছে!', 'success');
                        }
                    });
            }
        }

        function loadFinancialData() {
            const tbody = document.getElementById('financeTableBody');
            let totalIncome = 0;
            let totalExpense = 0;
            
            if (transactions.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" class="p-8 text-center text-gray-500">
                            <i class="fas fa-receipt text-4xl mb-3"></i>
                            <p class="text-lg font-medium">কোন লেনদেন নেই</p>
                            <p class="text-sm mt-2">নতুন লেনদেন যোগ করুন</p>
                        </td>
                    </tr>
                `;
            } else {
                tbody.innerHTML = transactions.map((t, index) => {
                    if (t.type === 'income') {
                        totalIncome += t.amount;
                    } else {
                        totalExpense += t.amount;
                    }
                    
                    return `
                        <tr class="border-b hover:bg-gray-50 transition duration-200">
                            <td class="p-4 text-gray-700">${new Date(t.date).toLocaleDateString('bn-BD')}</td>
                            <td class="p-4 text-gray-700">${t.desc}</td>
                            <td class="p-4">
                                <span class="px-3 py-1.5 rounded-full text-sm font-medium ${t.type === 'income' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                                    ${t.type === 'income' ? 'আয়' : 'ব্যয়'}
                                </span>
                            </td>
                            <td class="p-4 text-right font-bold ${t.type === 'income' ? 'text-green-700' : 'text-red-700'}">
                                ৳ ${toBanglaNumber(t.amount.toLocaleString('bn-BD'))}
                            </td>
                            <td class="p-4">
                                ${currentUser && currentUser.role === 'admin' ? `
                                    <button onclick="deleteTransaction('${t.id}')" class="text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50 transition duration-200">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                ` : `
                                    <span class="text-gray-400">${toBanglaNumber(index + 1)}</span>
                                `}
                            </td>
                        </tr>
                    `;
                }).join('');
            }
            
            // আর্থিক সারাংশ আপডেট
            document.getElementById('financeIncome').textContent = toBanglaNumber(totalIncome.toLocaleString('bn-BD'));
            document.getElementById('financeExpense').textContent = toBanglaNumber(totalExpense.toLocaleString('bn-BD'));
            document.getElementById('financeBalance').textContent = toBanglaNumber((totalIncome - totalExpense).toLocaleString('bn-BD'));
        }

        // ড্যাশবোর্ড আপডেট
        function updateDashboard() {
            // ছাত্র সংখ্যা
            document.getElementById('totalStudents').textContent = toBanglaNumber(students.length);
            
            // শিক্ষক সংখ্যা
            document.getElementById('totalTeachers').textContent = toBanglaNumber(teachers.length);
            
            // মাসিক আয়-ব্যয়
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            
            const monthlyIncome = transactions
                .filter(t => {
                    const transDate = new Date(t.date);
                    return t.type === 'income' && 
                           transDate.getMonth() === currentMonth && 
                           transDate.getFullYear() === currentYear;
                })
                .reduce((sum, t) => sum + t.amount, 0);
            
            const monthlyExpense = transactions
                .filter(t => {
                    const transDate = new Date(t.date);
                    return t.type === 'expense' && 
                           transDate.getMonth() === currentMonth && 
                           transDate.getFullYear() === currentYear;
                })
                .reduce((sum, t) => sum + t.amount, 0);
            
            document.getElementById('monthlyIncome').textContent = toBanglaNumber(monthlyIncome.toLocaleString('bn-BD'));
            document.getElementById('monthlyExpense').textContent = toBanglaNumber(monthlyExpense.toLocaleString('bn-BD'));
            
            // রিসেন্ট লেনদেন
            const recentTransactionsDiv = document.getElementById('recentTransactions');
            const recentTransactions = transactions.slice(0, 5);
            
            if (recentTransactions.length === 0) {
                recentTransactionsDiv.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-receipt text-3xl mb-3"></i>
                        <p>কোন লেনদেন নেই</p>
                    </div>
                `;
            } else {
                recentTransactionsDiv.innerHTML = recentTransactions.map((t, index) => `
                    <div class="flex items-center justify-between p-3 bg-gradient-to-r from-gray-50 to-white rounded-xl hover:shadow-md transition duration-200">
                        <div class="flex items-center">
                            <span class="index-badge mr-3 text-xs">${toBanglaNumber(index + 1)}</span>
                            <div>
                                <p class="font-semibold text-gray-800">${t.desc}</p>
                                <p class="text-sm text-gray-500">${new Date(t.date).toLocaleDateString('bn-BD')}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="font-bold ${t.type === 'income' ? 'text-green-600' : 'text-red-600'}">
                                ৳ ${toBanglaNumber(t.amount.toLocaleString('bn-BD'))}
                            </p>
                            <span class="text-xs font-medium ${t.type === 'income' ? 'text-green-500' : 'text-red-500'}">
                                ${t.type === 'income' ? 'আয়' : 'ব্যয়'}
                            </span>
                        </div>
                    </div>
                `).join('');
            }
            
            // শ্রেণি ভিত্তিক ডিস্ট্রিবিউশন
            const classDistribution = {};
            students.forEach(s => {
                classDistribution[s.class] = (classDistribution[s.class] || 0) + 1;
            });
            
            const classDistributionDiv = document.getElementById('classDistribution');
            classDistributionDiv.innerHTML = Object.keys(classDistribution).sort().map(cls => `
                <div class="flex items-center justify-between mb-3 p-2 hover:bg-gray-50 rounded-lg transition duration-200">
                    <span class="text-gray-700 font-medium">${toBanglaNumber(cls)}ম শ্রেণি</span>
                    <div class="flex items-center">
                        <span class="font-bold mr-3 text-gray-800">${toBanglaNumber(classDistribution[cls])} জন</span>
                        <div class="w-32 bg-gray-200 rounded-full h-3">
                            <div class="bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full" 
                                 style="width: ${(classDistribution[cls] / students.length * 100) || 0}%">
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // হাজিরা টেবিল লোড
        function loadAttendanceTable() {
            const tbody = document.getElementById('attendanceTableBody');
            const emptyState = document.getElementById('emptyAttendance');
            
            if (attendanceRecords.length === 0) {
                tbody.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }
            
            emptyState.classList.add('hidden');
            
            const filteredAttendance = filterAttendanceList();
            
            tbody.innerHTML = filteredAttendance.map((record, index) => {
                const teacher = teachers.find(t => t.id === record.teacherId) || {};
                const statusBadge = getStatusBadge(record.status);
                const date = new Date(record.date);
                const banglaDate = `${toBanglaNumber(date.getDate())} ${banglaMonths[date.getMonth()]} ${toBanglaNumber(date.getFullYear())}`;
                
                return `
                    <tr class="border-b hover:bg-gray-50 transition duration-200">
                        <td class="p-4 font-medium text-gray-800">${banglaDate}</td>
                        <td class="p-4">
                            <div class="font-semibold text-gray-800">${teacher.name || 'N/A'}</div>
                            <div class="text-sm text-gray-500">${teacher.teacherId || 'N/A'}</div>
                        </td>
                        <td class="p-4 text-gray-700">${teacher.designation || 'N/A'}</td>
                        <td class="p-4">
                            ${statusBadge}
                        </td>
                        <td class="p-4 text-gray-700">${record.inTime || 'N/A'}</td>
                        <td class="p-4 text-gray-700">${record.outTime || 'N/A'}</td>
                        <td class="p-4 text-gray-700 text-sm">${record.comments || 'N/A'}</td>
                        <td class="p-4">
                            ${currentUser && currentUser.role === 'admin' ? `
                                <button onclick="editAttendance('${record.id}')" class="text-blue-600 hover:text-blue-800 mr-3 p-2 rounded-lg hover:bg-blue-50 transition duration-200">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="deleteAttendance('${record.id}')" class="text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50 transition duration-200">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            ` : `
                                <span class="text-gray-400 text-sm">${toBanglaNumber(index + 1)}</span>
                            `}
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function getStatusBadge(status) {
            const statusMap = {
                'present': { text: 'উপস্থিত', class: 'bg-green-100 text-green-800' },
                'absent': { text: 'অনুপস্থিত', class: 'bg-red-100 text-red-800' },
                'late': { text: 'বিলম্বিত', class: 'bg-yellow-100 text-yellow-800' },
                'leave': { text: 'ছুটি', class: 'bg-blue-100 text-blue-800' }
            };
            
            const statusInfo = statusMap[status] || { text: 'অজানা', class: 'bg-gray-100 text-gray-800' };
            
            return `<span class="px-3 py-1.5 rounded-full text-sm font-medium ${statusInfo.class}">${statusInfo.text}</span>`;
        }

        // হাজিরা ফিল্টার
        function filterAttendance() {
            loadAttendanceTable();
            updateAttendanceSummary();
        }

        function filterAttendanceList() {
            const filterDate = document.getElementById('attendanceFilterDate').value;
            const filterMonth = document.getElementById('attendanceFilterMonth').value;
            const filterStatus = document.getElementById('attendanceFilterStatus').value;
            const searchTerm = document.getElementById('attendanceSearch').value.toLowerCase();
            
            let filtered = attendanceRecords;
            
            // তারিখ দ্বারা ফিল্টার
            if (filterDate) {
                filtered = filtered.filter(record => record.date === filterDate);
            }
            
            // মাস দ্বারা ফিল্টার
            if (filterMonth !== '') {
                filtered = filtered.filter(record => {
                    const date = new Date(record.date);
                    return date.getMonth().toString() === filterMonth;
                });
            }
            
            // অবস্থা দ্বারা ফিল্টার
            if (filterStatus) {
                filtered = filtered.filter(record => record.status === filterStatus);
            }
            
            // সার্চ টার্ম দ্বারা ফিল্টার
            if (searchTerm) {
                filtered = filtered.filter(record => {
                    const teacher = teachers.find(t => t.id === record.teacherId);
                    if (!teacher) return false;
                    
                    return teacher.name.toLowerCase().includes(searchTerm) ||
                           teacher.designation.toLowerCase().includes(searchTerm) ||
                           teacher.teacherId.toLowerCase().includes(searchTerm);
                });
            }
            
            // তারিখ অনুসারে সাজানো (নতুন থেকে পুরাতন)
            filtered.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            return filtered;
        }

        // হাজিরা সারাংশ আপডেট
        function updateAttendanceSummary() {
            const filtered = filterAttendanceList();
            
            let present = 0, absent = 0, late = 0, leave = 0;
            
            filtered.forEach(record => {
                switch(record.status) {
                    case 'present': present++; break;
                    case 'absent': absent++; break;
                    case 'late': late++; break;
                    case 'leave': leave++; break;
                }
            });
            
            document.getElementById('attendancePresentCount').textContent = toBanglaNumber(present);
            document.getElementById('attendanceAbsentCount').textContent = toBanglaNumber(absent);
            document.getElementById('attendanceLateCount').textContent = toBanglaNumber(late);
            document.getElementById('attendanceLeaveCount').textContent = toBanglaNumber(leave);
        }

        // হাজিরা সংরক্ষণ
        function saveAttendance() {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('শুধুমাত্র এডমিন এই ফিচার ব্যবহার করতে পারেন!', 'error');
                return;
            }
            
            const date = document.getElementById('attendanceDate').value;
            const teacherId = document.getElementById('attendanceTeacher').value;
            const status = document.getElementById('attendanceStatus').value;
            const inTime = document.getElementById('attendanceInTime').value;
            const outTime = document.getElementById('attendanceOutTime').value;
            const leaveType = document.getElementById('attendanceLeaveType').value;
            const comments = document.getElementById('attendanceComments').value.trim();
            
            // ভ্যালিডেশন
            if (!date || !teacherId || !status || !inTime) {
                showNotification('দয়া করে সকল প্রয়োজনীয় তথ্য প্রদান করুন (* চিহ্নিত ফিল্ড)', 'error');
                return;
            }
            
            // ছুটির ক্ষেত্রে ছুটির ধরন চেক
            if (status === 'leave' && !leaveType) {
                showNotification('দয়া করে ছুটির ধরন নির্বাচন করুন', 'error');
                return;
            }
            
            // একই শিক্ষকের একই তারিখে হাজিরা চেক
            if (currentAttendanceEditId === null) {
                const existingRecord = attendanceRecords.find(record => 
                    record.teacherId === teacherId && record.date === date
                );
                
                if (existingRecord) {
                    showNotification('এই শিক্ষকের আজকের জন্য ইতিমধ্যে হাজিরা রেকর্ড করা হয়েছে!', 'error');
                    return;
                }
            }
            
            const attendanceData = {
                date,
                teacherId,
                status,
                inTime,
                outTime: outTime || '',
                leaveType: status === 'leave' ? leaveType : '',
                comments,
                recordedBy: currentUser.email,
                timestamp: new Date().toISOString()
            };
            
            saveToFirebase('attendance', attendanceData, currentAttendanceEditId)
                .then(success => {
                    if (success) {
                        hideModal('addAttendanceModal');
                        showNotification(currentAttendanceEditId ? 'হাজিরা আপডেট করা হয়েছে!' : 'নতুন হাজিরা যোগ করা হয়েছে!', 'success');
                    }
                });
        }

        // হাজিরা এডিট
        function editAttendance(attendanceId) {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('শুধুমাত্র এডমিন এই ফিচার ব্যবহার করতে পারেন!', 'error');
                return;
            }
            
            const record = attendanceRecords.find(a => a.id === attendanceId);
            if (record) {
                currentAttendanceEditId = attendanceId;
                
                document.getElementById('attendanceDate').value = record.date;
                document.getElementById('attendanceInTime').value = record.inTime || '09:00';
                document.getElementById('attendanceOutTime').value = record.outTime || '17:00';
                document.getElementById('attendanceStatus').value = record.status;
                document.getElementById('attendanceComments').value = record.comments || '';
                
                // শিক্ষক নির্বাচন
                loadTeacherOptions();
                const teacherSelect = document.getElementById('attendanceTeacher');
                teacherSelect.value = record.teacherId;
                updateAttendanceDesignation();
                
                // ছুটির ধরন সেট
                if (record.status === 'leave') {
                    document.getElementById('attendanceLeaveType').value = record.leaveType || '';
                    document.getElementById('leaveTypeContainer').classList.remove('hidden');
                } else {
                    document.getElementById('leaveTypeContainer').classList.add('hidden');
                }
                
                document.getElementById('attendanceModalTitle').textContent = 'হাজিরা এডিট করুন';
                document.getElementById('addAttendanceModal').classList.remove('hidden');
            }
        }

        // হাজিরা ডিলিট
        function deleteAttendance(attendanceId) {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('শুধুমাত্র এডমিন এই ফিচার ব্যবহার করতে পারেন!', 'error');
                return;
            }
            
            if (confirm('আপনি কি এই হাজিরা রেকর্ড মুছতে চান?')) {
                deleteFromFirebase('attendance', attendanceId)
                    .then(success => {
                        if (success) {
                            showNotification('হাজিরা রেকর্ড মুছে ফেলা হয়েছে!', 'success');
                        }
                    });
            }
        }

        // এক্সপোর্ট ফাংশন
        function exportStudentData() {
            if (students.length === 0) {
                showNotification("রপ্তানি করার জন্য কোন ডেটা নেই!", "error");
                return;
            }
            
            let csvContent = "data:text/csv;charset=utf-8,\uFEFF";
            csvContent += "আইডি নম্বর,রোল নং,নাম,শ্রেণি,লিঙ্গ,পিতার নাম,মাতার নাম,মোবাইল,ইমেইল,গ্রাম,উপজেলা,জেলা,ভর্তির তারিখ\n";
            
            students.forEach((s, index) => {
                csvContent += `${s.studentIdNumber || (index + 1)},${s.roll},${s.name},${s.class}ম শ্রেণি,${s.gender},${s.fatherName},${s.motherName},${s.mobile || ''},${s.email || ''},${s.village},${s.upazila},${s.district},${s.admissionDate}\n`;
            });
            
            downloadCSV(csvContent, 'মাদ্রাসা_ছাত্র_তথ্য_১৮৭৫২');
        }

        function exportTeacherData() {
            if (teachers.length === 0) {
                showNotification("রপ্তানি করার জন্য কোন ডেটা নেই!", "error");
                return;
            }
            
            let csvContent = "data:text/csv;charset=utf-8,\uFEFF";
            csvContent += "আইডি নম্বর,ইনডেক্স নম্বর,নাম,পদবী,বিষয়/দায়িত্ব,মোবাইল,ইমেইল,বেতন,যোগদান তারিখ,এনআইডি,ঠিকানা,স্থায়ী ঠিকানা,প্রকার\n";
            
            teachers.forEach((t, index) => {
                csvContent += `${index + 1},${t.teacherId},${t.name},${t.designation},${t.subject || ''},${t.mobile},${t.email || ''},${t.salary},${t.joiningDate},${t.nid || ''},${t.address},${t.permanentAddress || ''},${t.type}\n`;
            });
            
            downloadCSV(csvContent, 'মাদ্রাসা_শিক্ষক_তথ্য_১৮৭৫২');
        }

        function exportAttendanceData() {
            if (attendanceRecords.length === 0) {
                showNotification("রপ্তানি করার জন্য কোন হাজিরা ডেটা নেই!", "error");
                return;
            }
            
            let csvContent = "data:text/csv;charset=utf-8,\uFEFF";
            csvContent += "ক্রমিক,তারিখ,শিক্ষক/কর্মচারীর নাম,পদবী,আইডি নং,হাজিরার অবস্থা,প্রবেশের সময়,প্রস্থানের সময়,ছুটির ধরন,মন্তব্য,রেকর্ড করার তারিখ\n";
            
            attendanceRecords.forEach((record, index) => {
                const teacher = teachers.find(t => t.id === record.teacherId) || {};
                const date = new Date(record.date);
                const banglaDate = `${toBanglaNumber(date.getDate())} ${banglaMonths[date.getMonth()]} ${toBanglaNumber(date.getFullYear())}`;
                const statusText = getStatusText(record.status);
                
                csvContent += `${index + 1},"${banglaDate}","${teacher.name || ''}","${teacher.designation || ''}","${teacher.teacherId || ''}","${statusText}","${record.inTime || ''}","${record.outTime || ''}","${record.leaveType || ''}","${record.comments || ''}","${new Date(record.timestamp).toLocaleDateString('bn-BD')}"\n`;
            });
            
            downloadCSV(csvContent, 'মাদ্রাসা_হাজিরা_তথ্য_১৮৭৫২');
        }

        function getStatusText(status) {
            const statusMap = {
                'present': 'উপস্থিত',
                'absent': 'অনুপস্থিত',
                'late': 'বিলম্বিত',
                'leave': 'ছুটি'
            };
            
            return statusMap[status] || status;
        }

        function downloadCSV(content, filename) {
            const encodedUri = encodeURI(content);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `${filename}_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification("ডেটা CSV ফাইল হিসেবে ডাউনলোড হয়েছে!", "success");
        }

        // PWA ইনস্টলেশন প্রম্পট
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // 5 সেকেন্ড পর ইনস্টল প্রম্পট দেখাবে
            setTimeout(() => {
                if (deferredPrompt) {
                    showInstallPrompt();
                }
            }, 5000);
        });

        function showInstallPrompt() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        showNotification('অ্যাপটি সফলভাবে ইনস্টল হয়েছে!', 'success');
                    }
                    deferredPrompt = null;
                });
            }
        }

        // Service Worker Registration (PWA caching)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }

        // ইনিশিয়াল লোড
        document.addEventListener('DOMContentLoaded', function() {
            updateBanglaDate();
            
            // তারিখ আপডেট
            setInterval(updateBanglaDate, 60000);
            
            // ডিফল্ট ভ্যালু সেট
            document.getElementById('financeDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('studentAdmissionDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('teacherJoiningDate').value = new Date().toISOString().split('T')[0];
            
            // রিমেমবার মি ফাংশনালিটি
            const rememberedEmail = localStorage.getItem('rememberedEmail');
            const rememberedRole = localStorage.getItem('rememberedRole');
            
            if (rememberedEmail && rememberedRole) {
                document.getElementById('loginEmail').value = rememberedEmail;
                document.getElementById('rememberMe').checked = true;
                selectRole(rememberedRole);
                
                // পাসওয়ার্ড খালি রাখবে
                document.getElementById('loginPassword').value = '';
            } else {
                selectRole('admin');
            }
            
            // লগইন বাটনে ইভেন্ট লিসেনার যোগ
            const loginButton = document.getElementById('loginBtn');
            const loginForm = document.getElementById('loginForm');
            
            if (loginForm) {
                loginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    login();
                });
            }
            
            // ইমেইল/পাসওয়ার্ড ফিল্ডে এন্টার প্রেস করলে লগইন
            const emailInput = document.getElementById('loginEmail');
            const passwordInput = document.getElementById('loginPassword');
            
            if (emailInput && passwordInput) {
                emailInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') login();
                });
                
                passwordInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') login();
                });
            }
            
            // মাদ্রাসা কোড সেট করুন
            console.log('মাদ্রাসা ম্যানেজমেন্ট সিস্টেম লোড হয়েছে');
            console.log('মাদ্রাসা কোড: ১৮৭৫২');
            console.log('EIIN No: ১৩০২৯০');
            console.log('মোবাইল: ০১৩০৯-১৩০২৯০');
            
            // ওয়েলকাম মেসেজ
            setTimeout(() => {
                showNotification('মাদ্রাসা ম্যানেজমেন্ট সিস্টেমে স্বাগতম!', 'info');
            }, 1000);
        });

        // অনলাইন/অফলাইন ডিটেকশন
        window.addEventListener('online', () => {
            updateSyncStatus('অনলাইন - ডেটা সিঙ্ক হচ্ছে...');
            showNotification('আপনি অনলাইনে আছেন', 'success');
        });

        window.addEventListener('offline', () => {
            updateSyncStatus('অফলাইন মোড - স্থানীয় ডেটা দেখানো হচ্ছে');
            showNotification('আপনি অফলাইনে আছেন', 'error');
        });
    </script>
</body>
</html>